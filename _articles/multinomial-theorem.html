---
title: Multinomial theorem
tags:
 - math
social_media:
   description: "A walkthrough of the multinomial theorem: how do you expand the square of (a + b + c + d + e + f)? How do you do it for a different number of additions, or a different exponent?"
extra_css_files:
 - lu-math.css
table_of_contents:
 - id:    begin
   title: Let's get started
 - id:    example
   title: An example
 - id:    conclusion
   title: Conclusion
   
---
{%- include lu-math/defines.html -%}
<section>
   <p>
      Suppose you have an expression of the form <lu-math data-inline>(<var>a</var> + <var>b</var> + <var>c</var> + <var>d</var> + <var>e</var> + <var>f</var><nobr>){{lu_math_sq}}</nobr></lu-math>, and you need to expand the square in order to solve some larger equation. How do you actually do that? More generally, is there an approach we can use to expand any group of added-together terms with any exponent?
   </p>
   <p>
      Yes. It's called <a href="https://en.wikipedia.org/wiki/Multinomial_theorem">the multinomial theorem</a>.
   </p>
</section>

<section>
   <h2><a name="begin"></a>Let's get started</h2>
   <p>
      The multinomial theorem can be used to expand any expression of the form <lu-math data-inline>(<var>x<sub>1</sub></var> + <var>x<sub>2</sub></var> + ... + <var>x<sub>m</sub></var>){% include lu-math/exponent.html exponent="<var>n</var>" %}</lu-math>. Let's take a look at the equation:
   </p>
   <lu-math>
      <lu-math-row>
         <lu-math-part>
            (<var>x<sub>1</sub></var> + <var>x<sub>2</sub></var> + ... + <var>x<sub>m</sub></var>){% include lu-math/exponent.html exponent="<var>n</var>" %}<nobr>
             =</nobr> 
         </lu-math-part>
         <lu-math-part>
            <lu-math-sequence data-operation="+-">
               <lu-math-seq-info>
                  <lu-math-raw>&Sigma;</lu-math-raw>
                  <lu-math-condition>
                     <lu-math-raw> for all </lu-math-raw>
                     <var>k<sub>1</sub></var> + <var>k<sub>2</sub></var> + ... + <var>k<sub>m</sub></var> = <var>n</var>; 
                     <var>k<sub>1</sub></var>,<var>k<sub>2</sub></var>,...,<var>k<sub>m</sub></var> &geq; 0
                     <lu-math-raw> do: </lu-math-raw>
                  </lu-math-condition>
               </lu-math-seq-info>
               <lu-math-seq-body><!--
               --><lu-math-raw>(</lu-math-raw><!--
                        
               --><lu-math-binomial-coefficient>
                     <lu-math-raw>(</lu-math-raw>
                     <li><var>n</var></li>
                     <lu-math-raw> choose (</lu-math-raw>
                     <li><var>k<sub>1</sub></var>,<var>k<sub>2</sub></var>,...,<var>k<sub>m</sub></var></li>
                     <lu-math-raw>))</lu-math-raw>
                  </lu-math-binomial-coefficient><!--
               --><lu-math-raw> &times; </lu-math-raw><!--
               --><lu-math-sequence data-operation="*">
                     <lu-math-seq-info>
                        <lu-math-raw>&Pi;</lu-math-raw>
                        <lu-math-seq-bounds>
                           <lu-math-raw> from </lu-math-raw>
                           <lu-math-bound-lower><var>t</var> = 1</lu-math-bound-lower>
                           <lu-math-raw> through </lu-math-raw>
                           <lu-math-bound-upper><var>m</var></lu-math-bound-upper>
                           <lu-math-raw> do: </lu-math-raw>
                        </lu-math-seq-bounds>
                     </lu-math-seq-info>
                     <lu-math-seq-body><!--
                     --><lu-math-raw>(</lu-math-raw><!--
                        
                     --><var>x<sub>t</sub></var>{% include lu-math/exponent.html exponent="<var>k<sub>t</sub></var>" %}<!--
                        
                     --><lu-math-raw>)</lu-math-raw><!--
                  --></lu-math-seq-body>
                  </lu-math-sequence><!--
                        
               --><lu-math-raw>)</lu-math-raw><!--
            --></lu-math-seq-body>
            </lu-math-sequence>
         
         </lu-math-part>
         <lu-math-raw-endcap> </lu-math-raw-endcap>
      </lu-math-row>
   </lu-math>
   <p>
      Oh. Uh...
   </p>
   <p>
      Well, to start with, those values below the summation symbol (&Sigma;) represent conditions. We have <lu-math data-inline><var>m</var></lu-math> variables named <lu-math data-inline><var>k<sub>something</sub></var></lu-math>, named <lu-math data-inline><var>k<sub>1</sub></var></lu-math> through <lu-math data-inline><var>k<sub>m</sub></var></lu-math>, and we have two conditions that apply to the lot of them. We are going to take <em>every possible combination of values</em> that meets these conditions, feed those values into the summation "body," and then compute the results and sum them all.
   </p>
   <p>
      The summation "body," meanwhile, has us multiply a collection of values &mdash; that's the capital-pi (&Pi;) symbol; it's the multiplication version of &Sigma; &mdash; and then multiply <em>that</em> by something else. The result is then added as part of the summation loop.
   </p>
   <p>
      The first condition on our summation loop is that the values must all add up to <lu-math data-inline><var>n</var></lu-math>, and the second condition is that they must all be greater than or equal to zero. This in turn implies that no one single value can be greater than <lu-math data-inline><var>n</var></lu-math>, as otherwise we'd need at least one of the others to be negative in order for this to work.
   </p>
   <p>
      <span class="different-wording-for-the-blind">
         <span class="sighted" aria-hidden="true">See the large parentheses, with the two rows and no symbol dividing them?</span>
         <span class="blind">Hear that one bit with the word "choose?" </span>
      </span>
      That's the notation for <dfn>binomial coefficients</dfn>. If we call the top number <lu-math data-inline><var>n</var></lu-math> and the bottom number <lu-math data-inline><var>k</var></lu-math>, then given the expression <lu-math data-inline>(1 + <var>x</var>){% include lu-math/exponent.html exponent="<var>k</var>" %}</lu-math>, we can compute the coefficient of <lu-math data-inline><var>x</var>{% include lu-math/exponent.html exponent="<var>k</var>" %}</lu-math> as follows:
   </p>
   <lu-math>
      <lu-math-row><!--
      --><lu-math-fraction><!--
         --><lu-math-numer><var>n</var>!</lu-math-numer><!--
         --><lu-math-raw> &divide; (</lu-math-raw><!--
         --><lu-math-denom><!--
            --><var>k</var>!(<var>n</var> - <var>k</var>)!<!--
         --></lu-math-deom><!--
         --><lu-math-raw>)</lu-math-raw><!--
      --></lu-math-fraction>
         <lu-math-raw-endcap> </lu-math-raw-endcap>
      </lu-math-row>
   </lu-math>
   <p>
      Wikipedia offers one example: <lu-math data-inline>(1 + <var>x</var>){% include lu-math/exponent.html exponent=4 %}</lu-math> is:
   </p>
   <lu-math>
      <lu-math-aligned data-right>
         <lu-math-row>
            <lu-math-part>
               (1 + <var>x</var>){% include lu-math/exponent.html exponent=4 %}
                = 
            </lu-math-part><!--
         --><lu-math-binomial-coefficient>
               <lu-math-raw>(</lu-math-raw>
               <li>4</li>
               <lu-math-raw> choose </lu-math-raw>
               <li>0</li>
               <lu-math-raw>)</lu-math-raw>
            </lu-math-binomial-coefficient><!--
         --><lu-math-part>
               <var>x</var>{% include lu-math/exponent.html exponent=0 %}
                + 
            </lu-math-part><!--
         --><lu-math-binomial-coefficient>
               <lu-math-raw>(</lu-math-raw>
               <li>4</li>
               <lu-math-raw> choose </lu-math-raw>
               <li>1</li>
               <lu-math-raw>)</lu-math-raw>
            </lu-math-binomial-coefficient><!--
         --><lu-math-part>
               <var>x</var>{% include lu-math/exponent.html exponent=1 %}
                + 
            </lu-math-part><!--
         --><lu-math-binomial-coefficient>
               <lu-math-raw>(</lu-math-raw>
               <li>4</li>
               <lu-math-raw> choose </lu-math-raw>
               <li>2</li>
               <lu-math-raw>)</lu-math-raw>
            </lu-math-binomial-coefficient><!--
         --><lu-math-part>
               <var>x</var>{{ lu_math_sq }}
                + 
            </lu-math-part><!--
         --><lu-math-binomial-coefficient>
               <lu-math-raw>(</lu-math-raw>
               <li>4</li>
               <lu-math-raw> choose </lu-math-raw>
               <li>3</li>
               <lu-math-raw>)</lu-math-raw>
            </lu-math-binomial-coefficient><!--
         --><lu-math-part>
               <var>x</var>{% include lu-math/exponent.html exponent=3 %}
                + 
            </lu-math-part><!--
         --><lu-math-binomial-coefficient>
               <lu-math-raw>(</lu-math-raw>
               <li>4</li>
               <lu-math-raw> choose </lu-math-raw>
               <li>4</li>
               <lu-math-raw>)</lu-math-raw>
            </lu-math-binomial-coefficient><!--
         --><lu-math-part>
               <var>x</var>{% include lu-math/exponent.html exponent=4 %}
            </lu-math-part>
         </lu-math-row>
         <lu-math-row>
            <lu-math-spacing>
               (1 + <var>x</var>){% include lu-math/exponent.html exponent=4 %}
            </lu-math-spacing><!--
         --><lu-math-part>&nbsp;=&nbsp;</lu-math-part><!--
         --><lu-math-fraction class="big-parens"><!--
            --><lu-math-numer>4!</lu-math-numer><!--
            --><lu-math-raw> &divide; (</lu-math-raw><!--
            --><lu-math-denom><!--
               -->0!(4 - 0)!<!--
            --></lu-math-deom><!--
            --><lu-math-raw>)</lu-math-raw><!--
         --></lu-math-fraction><!--
         --><lu-math-part>
               <var>x</var>{% include lu-math/exponent.html exponent=0 %}
                + 
            </lu-math-part><!--
         --><lu-math-fraction class="big-parens"><!--
            --><lu-math-numer>4!</lu-math-numer><!--
            --><lu-math-raw> &divide; (</lu-math-raw><!--
            --><lu-math-denom><!--
               -->1!(4 - 1)!<!--
            --></lu-math-deom><!--
            --><lu-math-raw>)</lu-math-raw><!--
         --></lu-math-fraction><!--
         --><lu-math-part>
               <var>x</var>{% include lu-math/exponent.html exponent=1 %}
                + 
            </lu-math-part><!--
         --><lu-math-fraction class="big-parens"><!--
            --><lu-math-numer>4!</lu-math-numer><!--
            --><lu-math-raw> &divide; (</lu-math-raw><!--
            --><lu-math-denom><!--
               -->2!(4 - 2)!<!--
            --></lu-math-deom><!--
            --><lu-math-raw>)</lu-math-raw><!--
         --></lu-math-fraction><!--
         --><lu-math-part>
               <var>x</var>{{ lu_math_sq }}
                + 
            </lu-math-part><!--
         --><lu-math-fraction class="big-parens"><!--
            --><lu-math-numer>4!</lu-math-numer><!--
            --><lu-math-raw> &divide; (</lu-math-raw><!--
            --><lu-math-denom><!--
               -->3!(4 - 3)!<!--
            --></lu-math-deom><!--
            --><lu-math-raw>)</lu-math-raw><!--
         --></lu-math-fraction><!--
         --><lu-math-part>
               <var>x</var>{% include lu-math/exponent.html exponent=3 %}
                + 
            </lu-math-part><!--
         --><lu-math-fraction class="big-parens"><!--
            --><lu-math-numer>4!</lu-math-numer><!--
            --><lu-math-raw> &divide; (</lu-math-raw><!--
            --><lu-math-denom><!--
               -->4!(4 - 4)!<!--
            --></lu-math-deom><!--
            --><lu-math-raw>)</lu-math-raw><!--
         --></lu-math-fraction><!--
         --><lu-math-part>
               <var>x</var>{% include lu-math/exponent.html exponent=4 %}
            </lu-math-part>
         </lu-math-row>
         <lu-math-row>
            <lu-math-spacing>
               (1 + <var>x</var>){% include lu-math/exponent.html exponent=4 %}
            </lu-math-spacing><!--
         --><lu-math-part>&nbsp;=&nbsp;</lu-math-part><!--
         --><lu-math-fraction class="big-parens"><!--
            --><lu-math-numer>24</lu-math-numer><!--
            --><lu-math-raw> &divide; (</lu-math-raw><!--
            --><lu-math-denom><!--
               -->24<!--
            --></lu-math-deom><!--
            --><lu-math-raw>)</lu-math-raw><!--
         --></lu-math-fraction><!--
         --><lu-math-part>
                &times; 1
                + 
            </lu-math-part><!--
         --><lu-math-fraction class="big-parens"><!--
            --><lu-math-numer>24</lu-math-numer><!--
            --><lu-math-raw> &divide; (</lu-math-raw><!--
            --><lu-math-denom><!--
               -->6<!--
            --></lu-math-deom><!--
            --><lu-math-raw>)</lu-math-raw><!--
         --></lu-math-fraction><!--
         --><lu-math-part>
               <var>x</var>{% include lu-math/exponent.html exponent=1 %}
                + 
            </lu-math-part><!--
         --><lu-math-fraction class="big-parens"><!--
            --><lu-math-numer>24</lu-math-numer><!--
            --><lu-math-raw> &divide; (</lu-math-raw><!--
            --><lu-math-denom><!--
               -->2 &times; 2<!--
            --></lu-math-deom><!--
            --><lu-math-raw>)</lu-math-raw><!--
         --></lu-math-fraction><!--
         --><lu-math-part>
               <var>x</var>{{ lu_math_sq }}
                + 
            </lu-math-part><!--
         --><lu-math-fraction class="big-parens"><!--
            --><lu-math-numer>24</lu-math-numer><!--
            --><lu-math-raw> &divide; (</lu-math-raw><!--
            --><lu-math-denom><!--
               -->6<!--
            --></lu-math-deom><!--
            --><lu-math-raw>)</lu-math-raw><!--
         --></lu-math-fraction><!--
         --><lu-math-part>
               <var>x</var>{% include lu-math/exponent.html exponent=3 %}
                + 
            </lu-math-part><!--
         --><lu-math-fraction class="big-parens"><!--
            --><lu-math-numer>24</lu-math-numer><!--
            --><lu-math-raw> &divide; (</lu-math-raw><!--
            --><lu-math-denom><!--
               -->24<!--
            --></lu-math-deom><!--
            --><lu-math-raw>)</lu-math-raw><!--
         --></lu-math-fraction><!--
         --><lu-math-part>
               <var>x</var>{% include lu-math/exponent.html exponent=4 %}
            </lu-math-part>
         </lu-math-row>
         <lu-math-row>
            <lu-math-spacing>
               (1 + <var>x</var>){% include lu-math/exponent.html exponent=4 %}
            </lu-math-spacing><!--
         --><lu-math-part>&nbsp;=&nbsp;</lu-math-part>
            <lu-math-part>
               1
                + 
               4<var>x</var>{% include lu-math/exponent.html exponent=1 %}
                + 
               6<var>x</var>{{ lu_math_sq }}
                + 
               4<var>x</var>{% include lu-math/exponent.html exponent=3 %}
                + 
               <var>x</var>{% include lu-math/exponent.html exponent=4 %}
            </lu-math-part>
         </lu-math-row>
      </lu-math-aligned>
   </lu-math>
   <p>
      Apparently, that generalizes to larger "multinomials;" if your multinomial has <lu-math data-inline><var>r</var></lu-math> terms in it, then you'd do:
   </p>
   <lu-math>
      <lu-math-row><!--
      --><lu-math-part>
            <lu-math-raw-endcap> </lu-math-raw-endcap>
            <lu-math-binomial-coefficient>
               <lu-math-raw>(</lu-math-raw>
               <li><var>n</var></li>
               <lu-math-raw> and (</lu-math-raw>
               <li><var>k<sub>1</sub></var>,<var>k<sub>2</sub></var>,...,<var>k<sub>r</sub></var></li>
               <lu-math-raw>)</lu-math-raw>
            </lu-math-binomial-coefficient>
         </lu-math-part>
          = <!--
      --><lu-math-fraction><!--
         --><lu-math-numer><var>n</var>!</lu-math-numer><!--
         --><lu-math-raw> &divide; (</lu-math-raw><!--
         --><lu-math-denom><!--
            --><var>k<sub>1</sub></var>!<var>k<sub>2</sub></var>!...<var>k<sub>r</sub></var>!<!--
         --></lu-math-deom><!--
         --><lu-math-raw>)</lu-math-raw><!--
      --></lu-math-fraction>
         <lu-math-raw-endcap> </lu-math-raw-endcap>
      </lu-math-row>
   </lu-math>
   <p>
      Given a multinomial with <lu-math data-inline><var>r</var></lu-math> terms, the variable <lu-math data-inline><var>k<sub>i</sub></var></lu-math> is defined below &mdash; and as a reminder, this is summation, not a single variable:
   </p>
   <lu-math>
      <lu-math-row>
         <lu-math-part>
            <lu-math-sequence data-operation="+-">
               <lu-math-seq-info>
                  <lu-math-raw>&Sigma;</lu-math-raw>
                  <lu-math-seq-bounds>
                     <lu-math-raw> from </lu-math-raw>
                     <lu-math-bound-lower><var>i</var> = 1</lu-math-bound-lower>
                     <lu-math-raw> through </lu-math-raw>
                     <lu-math-bound-upper><var>r</var></lu-math-bound-upper>
                     <lu-math-raw> do: </lu-math-raw>
                  </lu-math-seq-bounds>
               </lu-math-seq-info>
               <lu-math-seq-body><!--
               --><lu-math-raw>(</lu-math-raw><!--
                  
               --><var>k<sub>i</sub></var><!--
                  
               --><lu-math-raw>)</lu-math-raw><!--
            --></lu-math-seq-body>
            </lu-math-sequence>
         </lu-math-part>
         <lu-math-part>
             = 
            <var>n</var>
         </lu-math-part>
      </lu-math-row>
   </lu-math>
   <p>
      This is all getting pretty out-there, so let's come back to Earth by actually using this.
   </p>
</section>

<section>
   <h2><a name="example"></a>An example</h2>
   <p>
      We'll go with the example I led in with: <lu-math data-inline>(<var>a</var> + <var>b</var> + <var>c</var> + <var>d</var> + <var>e</var> + <var>f</var><nobr>){{lu_math_sq}}</nobr></lu-math>. We have a multinomial that we want to square, so <lu-math data-inline><var>n</var></lu-math> is 2. Our multinomial has six terms, so <lu-math data-inline><var>m</var></lu-math> is 6.
   </p>
   <lu-math>
      <lu-math-row>
         <lu-math-part>
            (<var>x<sub>1</sub></var> + <var>x<sub>2</sub></var> + <var>x<sub>3</sub></var> + <var>x<sub>4</sub></var> + <var>x<sub>5</sub></var> + <var>x<sub>6</sub></var>){{ lu_math_sq }}<nobr>
             =</nobr> 
         </lu-math-part>
         <lu-math-part>
            <lu-math-sequence data-operation="+-">
               <lu-math-seq-info>
                  <lu-math-raw>&Sigma;</lu-math-raw>
                  <lu-math-condition>
                     <lu-math-raw> for all </lu-math-raw>
                     <var>k<sub>1</sub></var> + <var>k<sub>2</sub></var> + ... + <var>k<sub>6</sub></var> = 2; 
                     <var>k<sub>1</sub></var>,<var>k<sub>2</sub></var>,...,<var>k<sub>6</sub></var> &geq; 0
                     <lu-math-raw> do: </lu-math-raw>
                  </lu-math-condition>
               </lu-math-seq-info>
               <lu-math-seq-body><!--
               --><lu-math-raw>(</lu-math-raw><!--
                        
               --><lu-math-binomial-coefficient>
                     <lu-math-raw>(</lu-math-raw>
                     <li>2</li>
                     <lu-math-raw> and (</lu-math-raw>
                     <li><var>k<sub>1</sub></var>,<var>k<sub>2</sub></var>,...,<var>k<sub>6</sub></var></li>
                     <lu-math-raw>)</lu-math-raw>
                  </lu-math-binomial-coefficient><!--
               --><lu-math-raw> &times; </lu-math-raw><!--
               --><lu-math-sequence data-operation="*">
                     <lu-math-seq-info>
                        <lu-math-raw>&Pi;</lu-math-raw>
                        <lu-math-seq-bounds>
                           <lu-math-raw> from </lu-math-raw>
                           <lu-math-bound-lower><var>t</var> = 1</lu-math-bound-lower>
                           <lu-math-raw> through </lu-math-raw>
                           <lu-math-bound-upper>6</lu-math-bound-upper>
                           <lu-math-raw> do: </lu-math-raw>
                        </lu-math-seq-bounds>
                     </lu-math-seq-info>
                     <lu-math-seq-body><!--
                     --><lu-math-raw>(</lu-math-raw><!--
                        
                     --><var>x<sub>t</sub></var>{% include lu-math/exponent.html exponent="<var>k<sub>t</sub></var>" %}<!--
                        
                     --><lu-math-raw>)</lu-math-raw><!--
                  --></lu-math-seq-body>
                  </lu-math-sequence><!--
                        
               --><lu-math-raw>)</lu-math-raw><!--
            --></lu-math-seq-body>
            </lu-math-sequence>
         
         </lu-math-part>
         <lu-math-raw-endcap> </lu-math-raw-endcap>
      </lu-math-row>
      <lu-math-row>
         <lu-math-part>
            (<var>x<sub>1</sub></var> + <var>x<sub>2</sub></var> + <var>x<sub>3</sub></var> + <var>x<sub>4</sub></var> + <var>x<sub>5</sub></var> + <var>x<sub>6</sub></var>){{ lu_math_sq }}<nobr>
             =</nobr> 
         </lu-math-part>
         <lu-math-part>
            <lu-math-sequence data-operation="+-">
               <lu-math-seq-info>
                  <lu-math-raw>&Sigma;</lu-math-raw>
                  <lu-math-condition>
                     <lu-math-raw> for all </lu-math-raw>
                     <var>k<sub>1</sub></var> + <var>k<sub>2</sub></var> + ... + <var>k<sub>6</sub></var> = 2; 
                     <var>k<sub>1</sub></var>,<var>k<sub>2</sub></var>,...,<var>k<sub>6</sub></var> &geq; 0
                     <lu-math-raw> do: </lu-math-raw>
                  </lu-math-condition>
               </lu-math-seq-info>
               <lu-math-seq-body><!--
               --><lu-math-raw>(</lu-math-raw><!--
                        
               --><lu-math-fraction><!--
                  --><lu-math-numer>2!</lu-math-numer><!--
                  --><lu-math-raw> &divide; (</lu-math-raw><!--
                  --><lu-math-denom><!--
                     --><var>k<sub>1</sub></var>!<var>k<sub>2</sub></var>!...<var>k<sub>6</sub></var>!<!--
                  --></lu-math-deom><!--
                  --><lu-math-raw>)</lu-math-raw><!--
               --></lu-math-fraction><!--
               --><lu-math-raw> &times; </lu-math-raw><!--
               --><lu-math-sequence data-operation="*">
                     <lu-math-seq-info>
                        <lu-math-raw>&Pi;</lu-math-raw>
                        <lu-math-seq-bounds>
                           <lu-math-raw> from </lu-math-raw>
                           <lu-math-bound-lower><var>t</var> = 1</lu-math-bound-lower>
                           <lu-math-raw> through </lu-math-raw>
                           <lu-math-bound-upper>6</lu-math-bound-upper>
                           <lu-math-raw> do: </lu-math-raw>
                        </lu-math-seq-bounds>
                     </lu-math-seq-info>
                     <lu-math-seq-body><!--
                     --><lu-math-raw>(</lu-math-raw><!--
                        
                     --><var>x<sub>t</sub></var>{% include lu-math/exponent.html exponent="<var>k<sub>t</sub></var>" %}<!--
                        
                     --><lu-math-raw>)</lu-math-raw><!--
                  --></lu-math-seq-body>
                  </lu-math-sequence><!--
                        
               --><lu-math-raw>)</lu-math-raw><!--
            --></lu-math-seq-body>
            </lu-math-sequence>
         
         </lu-math-part>
         <lu-math-raw-endcap> </lu-math-raw-endcap>
      </lu-math-row>
   </lu-math>
   <p>
      This equation is a nested loop. The outermost loop has six iterator variables, and the innermost loop just goes over those. It's a bit like this:
   </p>
<pre><code>int[...][6] all_possible_k_arrays = ...;

int[6] k;

// summation (big weird "E" symbol):
sum = 0;
for each k[1], k[2], k[3], k[4], k[5], k[6] matching conditions, do:

   // capital-pi thing:
   product = 1;
   for t = 1 to k.length do
      product *= ...;
   end
   
   // multiply by factorial fraction:
   product *= ...;
   
   sum += product;
end</code></pre>
   <p>
      We need to start at the innermost loop and work our way outward to understand this, but the innermost loop uses the six "loop index" variables, <lu-math data-inline><var>k<sub>i</sub></var></lu-math>, that belong to our outer loop. That means that we need to figure out what those variables are.
   </p>
   <h3>Computing our outer loop variables</h3>
   <p>
      Let's compute the values of all possible combinations of <lu-math data-inline><var>k<sub>i</sub></var></lu-math> for our 6-term monomial. We know that there must be six of these values, they must sum to 2, and none of them can be negative.
   </p>
   <p>
      Here's a list of every possible combination of numbers (between zero and 2, inclusive) that can add up to 2:
   </p>
   <ul>
      <li>2</li>
      <li>1 + 1</li>
   </ul>
   <p>
      Of course, we need to distribute those possibilities across sets of six total numbers, where any extra numbers just get set to zero. This means we'll have a lot of repeats &mdash; the same numbers being added together, but with the numbers in different slots among the six we have available. Here's what that looks like:
   </p>
   {%- assign possibilities = "" -%}
   {%- assign count = 6 -%}
   {%- for i in (1..count) -%}
      {%- unless forloop.first -%}
         {%- assign possibilities = possibilities | append: "," -%}
      {%- endunless -%}
      {%- for j in (1..count) -%}
         {%- unless forloop.first -%}
            {%- assign possibilities = possibilities | append: "," -%}
         {%- endunless -%}
         {%- if j == i -%}
            {%- assign possibilities = possibilities | append: "2" -%}
         {%- else -%}
            {%- assign possibilities = possibilities | append: "0" -%}
         {%- endif -%}
      {%- endfor -%}
   {%- endfor -%}
   {%- for i in (1..count) -%}
      {%- for j in (i..count) offset:1 -%}
         {%- comment -%}
            The loop offset skips the i == j case.
         {%- endcomment -%}
         {%- for k in (1..count) -%}
            {%- if k != i and k != j -%}
               {%- assign possibilities = possibilities | append: ",0" -%}
            {%- else -%}
               {%- assign possibilities = possibilities | append: ",1" -%}
            {%- endif -%}
         {%- endfor -%}
      {%- endfor -%}
   {%- endfor -%}
   {%- assign possibilities      = possibilities | split: "," -%}
   {%- assign possible_set_count = possibilities.size | divided_by: 6 -%}
   <table class="fade-zeroes">
      <thead>
         <tr>
            <th>
               Form
            </th>
            {%- for i in (1..6) -%}
               <th>
                  <lu-math data-inline><var>k<sub>{{ i }}</sub></var></lu-math>
               </th>
            {%- endfor -%}
            <th>
               Expression
            </th>
            <th>
               Sum
            </th>
         </tr>
      </thead>
      <tbody>
         {%- for i in (1..possible_set_count) -%}
         {%- assign last_form = "" -%}
         <tr>
            {%- assign last_form = form -%}
            {%- assign form = "1 + 1" -%}
            {%- assign form_rowspan = possible_set_count | minus: count -%}
            {%- if i <= count -%}
               {%- assign form = "2 + 0" -%}
               {%- assign form_rowspan = count -%}
            {%- endif -%}
            
            {%- assign start = i | minus: 1 | times: count -%}
            {%- assign current_set = possibilities | slice: start, count -%}
            
            {%- for item in current_set -%}
               {%- if forloop.first and form != last_form -%}
            <th rowSpan="{{ form_rowspan }}">
               {{ form }}
            </th>
               {%- endif -%}
            <td data-type="number" data-value="{{ item }}">{{ item }}</td>
            {%- endfor -%}
            <td>
               {%- for item in current_set -%}
                  {%- unless forloop.first %} + {% endunless -%}
                  {{ item }}
               {%- endfor -%}
            </td>
            <td data-type="number">
               {%- assign sum = 0 -%}
               {%- for item in current_set -%}
                  {%- assign sum = sum | plus: item -%}
               {%- endfor -%}
               {{ sum }}
            </td>
         </tr>
         {%- endfor -%}
      </tbody>
   </table>
   
   <h3>Dealing with the inner loop</h3>
   <p>
      That's a <em>lot</em> of combinations up there, but let's actually use them and see how that shakes out. The <lu-math data-inline><var>k<sub>i</sub></var></lu-math> variables are used in two ways:
   </p>
   <ul>
      <li>
         For each <lu-math data-inline><var>k<sub>i</sub></var></lu-math> in any valid set of values, we compute <lu-math data-inline><var>x<sub>i</sub></var>{% include lu-math/exponent.html exponent="<var>k<sub>i</sub></var>" %}</lu-math>. We then multply all of these together; this is the inner loop, called a <dfn>sequence of products</dfn> and indicated with the capital pi (&Pi;).
      </li>
      <li>
         After the inner loop is done, we compute the multinomial coefficient (the fraction with the factorials in it), and multiply that with the sequence of products.
      </li>
   </ul>
   <p>
      So let's start by substituting in our <lu-math data-inline><var>x<sub>i</sub></var>{% include lu-math/exponent.html exponent="<var>k<sub>i</sub></var>" %}</lu-math> values. We'll keep things simple: instead of using the actual terms from our multinomial (for <lu-math data-inline><var>x<sub>i</sub></var></lu-math>), we'll represent the whole multinomial as <lu-math data-inline><var>a</var> + <var>b</var> + <var>c</var> + <var>d</var> + <var>e</var> + <var>f</var></lu-math>.
   </p>
   <table>
      <thead>
         <tr>
            <th>
               Form
            </th>
            {%- for i in (1..6) -%}
               <th>
                  {%- capture ex -%}<var>k<sub>{{ i }}</sub></var>{%- endcapture -%}
                  <lu-math data-inline><var>x<sub>{{ i }}</sub></var>{% include lu-math/exponent.html exponent=ex -%}</lu-math>
               </th>
            {%- endfor -%}
         </tr>
      </thead>
      <tbody>
         {%- for i in (1..possible_set_count) -%}
         {%- assign last_form = "" -%}
         {%- assign vars = "a,b,c,d,e,f" | split: "," -%}
         <tr>
            {%- assign last_form = form -%}
            {%- assign form = "1 + 1" -%}
            {%- assign form_rowspan = possible_set_count | minus: count -%}
            {%- if i <= count -%}
               {%- assign form = "2 + 0" -%}
               {%- assign form_rowspan = count -%}
            {%- endif -%}
            
            {%- assign start = i | minus: 1 | times: count -%}
            {%- assign current_set = possibilities | slice: start, count -%}
            
            {%- for item in current_set -%}
               {%- if forloop.first and form != last_form -%}
            <th rowSpan="{{ form_rowspan }}">
               {{ form }}
            </th>
               {%- endif -%}
            <td {% if item == "0" -%} class="deemphasize" {%- endif -%}>
               <var>{{ vars[forloop.index0] }}</var>{%- include lu-math/exponent.html exponent=item %}
            </td>
            {%- endfor -%}
         </tr>
         {%- endfor -%}
      </tbody>
   </table>
   <p>
      Now, if you take any value to the zeroth power, then you get 1, so we can strike a lot of terms from that table and just replace them with ones. Similarly, a term to the first power is just itself, so we can strip the exponent.
   </p>
   <table>
      <thead>
         <tr>
            <th>
               Form
            </th>
            {%- for i in (1..6) -%}
               <th>
                  {%- capture ex -%}<var>k<sub>{{ i }}</sub></var>{%- endcapture -%}
                  <lu-math data-inline><var>x<sub>{{ i }}</sub></var>{% include lu-math/exponent.html exponent=ex -%}</lu-math>
               </th>
            {%- endfor -%}
         </tr>
      </thead>
      <tbody>
         {%- for i in (1..possible_set_count) -%}
         {%- assign last_form = "" -%}
         {%- assign vars = "a,b,c,d,e,f" | split: "," -%}
         <tr>
            {%- assign last_form = form -%}
            {%- assign form = "1 + 1" -%}
            {%- assign form_rowspan = possible_set_count | minus: count -%}
            {%- if i <= count -%}
               {%- assign form = "2 + 0" -%}
               {%- assign form_rowspan = count -%}
            {%- endif -%}
            
            {%- assign start = i | minus: 1 | times: count -%}
            {%- assign current_set = possibilities | slice: start, count -%}
            
            {%- for item in current_set -%}
               {%- if forloop.first and form != last_form -%}
            <th rowSpan="{{ form_rowspan }}">
               {{ form }}
            </th>
               {%- endif -%}
            <td {% if item == "0" -%} class="deemphasize" {%- endif -%}>
               {%- if item == "0" -%}
                  1
               {%- else -%}
                  <var>{{ vars[forloop.index0] }}</var>
                  {%- if item != "1" -%}
                     {%- include lu-math/exponent.html exponent=item %}
                  {%- endif -%}
               {%- endif -%}
            </td>
            {%- endfor -%}
         </tr>
         {%- endfor -%}
      </tbody>
   </table>
   <p>
      Now let's add the multinomial coefficients to the table:
   </p>
   <table>
      <thead>
         <tr>
            <th>
               Form
            </th>
            {%- for i in (1..6) -%}
               <th>
                  <lu-math data-inline><var>i = {{ i }}</var></lu-math>
               </th>
            {%- endfor -%}
            <th><abbr title="Multinomial Coefficients">MCs</abbr></th>
         </tr>
      </thead>
      <tbody>
         {%- assign two_factorial = 2 | times: 1 -%}
         {%- for i in (1..possible_set_count) -%}
         {%- assign last_form = "" -%}
         {%- assign vars = "a,b,c,d,e,f" | split: "," -%}
         <tr>
            {%- assign last_form = form -%}
            {%- assign form = "1 + 1" -%}
            {%- assign form_rowspan = possible_set_count | minus: count -%}
            {%- if i <= count -%}
               {%- assign form = "2 + 0" -%}
               {%- assign form_rowspan = count -%}
            {%- endif -%}
            
            {%- assign start = i | minus: 1 | times: count -%}
            {%- assign current_set = possibilities | slice: start, count -%}
            
            {%- for item in current_set -%}
               {%- if forloop.first and form != last_form -%}
            <th rowSpan="{{ form_rowspan }}">
               {{ form }}
            </th>
               {%- endif -%}
            <td {% if item == "0" -%} class="deemphasize" {%- endif -%}>
               {%- if item == "0" -%}
                  1
               {%- else -%}
                  <var>{{ vars[forloop.index0] }}</var>
                  {%- if item != "1" -%}
                     {%- include lu-math/exponent.html exponent=item %}
                  {%- endif -%}
               {%- endif -%}
            </td>
            {%- endfor -%}
            <td data-type="number">
               {%- assign numer = 2 -%}
               {%- assign denom = 1 -%}
               {%- for item in current_set -%}
                  {%- assign fact = 1 -%}
                  {%- for n in (1..item) -%}
                     {%- assign fact = fact | times: n -%}
                  {%- endfor -%}
                  {%- assign denom = denom | times: fact -%}
               {%- endfor -%}
               {%- if denom == 0 -%}
                  {%- assign denom = 1 -%}
               {%- endif -%}
               {%- assign denom = numer | divided_by: denom -%}
               {{ denom }}
            </td>
         </tr>
         {%- endfor -%}
      </tbody>
   </table>
   
   <h3>Putting it all together</h3>
   <p>
      Remember that each row represents a valid set of possible values for the <lu-math data-inline><var>k<sub>1</sub></var></lu-math> through <lu-math data-inline><var>k<sub>6</sub></var></lu-math> variables. Each row represents the values we'll use in this part of the formula:
   </p>
   <lu-math>
      <lu-math-row>
         <lu-math-raw-endcap> </lu-math-raw-endcap>
         <lu-math-part>
            <lu-math-fraction><!--
            --><lu-math-numer>2!</lu-math-numer><!--
            --><lu-math-raw> &divide; (</lu-math-raw><!--
            --><lu-math-denom><!--
               --><var>k<sub>1</sub></var>!<var>k<sub>2</sub></var>!...<var>k<sub>6</sub></var>!<!--
            --></lu-math-deom><!--
            --><lu-math-raw>)</lu-math-raw><!--
         --></lu-math-fraction><!--
         --><lu-math-raw> &times; </lu-math-raw><!--
         --><lu-math-sequence data-operation="*">
               <lu-math-seq-info>
                  <lu-math-raw>&Pi;</lu-math-raw>
                  <lu-math-seq-bounds>
                     <lu-math-raw> from </lu-math-raw>
                     <lu-math-bound-lower><var>t</var> = 1</lu-math-bound-lower>
                     <lu-math-raw> through </lu-math-raw>
                     <lu-math-bound-upper>6</lu-math-bound-upper>
                     <lu-math-raw> do: </lu-math-raw>
                  </lu-math-seq-bounds>
               </lu-math-seq-info>
               <lu-math-seq-body><!--
               --><lu-math-raw>(</lu-math-raw><!--
                  
               --><var>x<sub>t</sub></var>{% include lu-math/exponent.html exponent="<var>k<sub>t</sub></var>" %}<!--
                  
               --><lu-math-raw>)</lu-math-raw><!--
            --></lu-math-seq-body>
            </lu-math-sequence>
         </lu-math-part>
         <lu-math-raw-endcap> </lu-math-raw-endcap>
      </lu-math-row>
   </lu-math>
   <p>
      If we multiply all the items in a row together, then we'll get the result of that expression for that given set of <lu-math data-inline><var>k<sub>i</sub></var></lu-math> values. Let's see what that looks like. We can skip every cell in the table that's just the number 1, so in practice, 90% of that table is gone:
   </p>
   <table>
      <thead>
         <tr>
            <th>Form</th>
            <th>Full entry</th>
            <th>Collapsed</th>
            <th>Final</th>
         </tr>
      </thead>
      <tbody>
         {%- assign vars = "a,b,c,d,e,f" | split: "," -%}
         {%- for i in (1..possible_set_count) -%}
            {%- assign start = i | minus: 1 | times: count -%}
            {%- assign current_set = possibilities | slice: start, count -%}
            
            {%- assign last_form = form -%}
            {%- assign form = "1 + 1" -%}
            {%- assign form_rowspan = possible_set_count | minus: count -%}
            {%- if i <= count -%}
               {%- assign form = "2 + 0" -%}
               {%- assign form_rowspan = count -%}
            {%- endif -%}
            
            {%- assign numer = 2 -%}
            {%- assign denom = 1 -%}
            {%- for item in current_set -%}
               {%- assign fact = 1 -%}
               {%- for n in (1..item) -%}
                  {%- assign fact = fact | times: n -%}
               {%- endfor -%}
               {%- assign denom = denom | times: fact -%}
            {%- endfor -%}
            {%- if denom == 0 -%}
               {%- assign denom = 1 -%}
            {%- endif -%}
            {%- assign frac = numer | divided_by: denom -%}
            
            <tr>
               {%- if form != last_form -%}
               <th rowSpan="{{ form_rowspan }}">
                  {{ form }}
               </th>
               {%- endif -%}
               <td>
                  {%- for item in current_set -%}
                     {%- unless forloop.first %} &times; {% endunless -%}
                     {%- if item != "0" -%}
                        <var>{{ vars[forloop.index0] }}</var>
                        {%- if item != "1" -%}
                           {%- include lu-math/exponent.html exponent=item %}
                        {%- endif -%}
                     {%- else -%}
                        1
                     {%- endif -%}
                  {%- endfor %} &times; {{frac}}
               </td>
               <td>
                  {%- assign wrote_any = false -%}
                  {%- for item in current_set -%}
                     {%- if item != "0" -%}
                        {%- unless wrote_any == false %} &times; {% endunless -%}
                        {%- assign wrote_any = true -%}
                        <var>{{ vars[forloop.index0] }}</var>
                        {%- if item != "1" -%}
                           {%- include lu-math/exponent.html exponent=item %}
                        {%- endif -%}
                     {%- endif -%}
                  {%- endfor %} &times; {{frac}}
               </td>
               <td>
                  {%- if frac != 1 -%}
                     {{ frac }}
                  {%- endif -%}
                  {%- for item in current_set -%}
                     {%- if item != "0" -%}
                        <var>{{ vars[forloop.index0] }}</var>
                        {%- if item != "1" -%}
                           {%- include lu-math/exponent.html exponent=item %}
                        {%- endif -%}
                     {%- endif -%}
                  {%- endfor -%}
               </td>
            </tr>
         {%- endfor -%}
      </tbody>
   </table>
   <p>
      So those are all the possible values of that one expression. Where were we using it again?
   </p>
   <lu-math>
      <lu-math-row>
         <lu-math-part>
            (<var>a</var> + <var>b</var> + <var>c</var> + <var>d</var> + <var>e</var> + <var>f</var>){{ lu_math_sq }}<nobr>
             =</nobr> 
         </lu-math-part>
         <lu-math-part>
            <lu-math-sequence data-operation="+-">
               <lu-math-seq-info data-no-params>
                  <lu-math-raw>&Sigma;</lu-math-raw>
                  <lu-math-condition> </lu-math-condition>
               </lu-math-seq-info>
               <lu-math-seq-body><!--
               --><lu-math-raw>(</lu-math-raw><!--
                        
               --><label>It all goes here.</label><!--
                        
               --><lu-math-raw>)</lu-math-raw><!--
            --></lu-math-seq-body>
            </lu-math-sequence>
         
         </lu-math-part>
         <lu-math-raw-endcap> </lu-math-raw-endcap>
      </lu-math-row>
   </lu-math>
   <p>
      Right! We were going to add those final items together. Let's see what that looks like:
   </p>
   <lu-math>
      <lu-math-row>
         <lu-math-part>
            (<var>a</var> + <var>b</var> + <var>c</var> + <var>d</var> + <var>e</var> + <var>f</var>){{ lu_math_sq }}<nobr>
             =</nobr> 
         </lu-math-part>
         <lu-math-part>
            {%- assign vars = "a,b,c,d,e,f" | split: "," -%}
            {%- for i in (1..possible_set_count) -%}
               {%- assign start = i | minus: 1 | times: count -%}
               {%- assign current_set = possibilities | slice: start, count -%}
               
               {%- unless forloop.first %} + {% endunless -%}
               
               {%- assign numer = 2 -%}
               {%- assign denom = 1 -%}
               {%- for item in current_set -%}
                  {%- assign fact = 1 -%}
                  {%- for n in (1..item) -%}
                     {%- assign fact = fact | times: n -%}
                  {%- endfor -%}
                  {%- assign denom = denom | times: fact -%}
               {%- endfor -%}
               {%- if denom == 0 -%}
                  {%- assign denom = 1 -%}
               {%- endif -%}
               {%- assign denom = numer | divided_by: denom -%}
               {%- if denom != 1 -%}
                  {{ denom }}
               {%- endif -%}
               
               {%- for item in current_set -%}
                  {%- if item != "0" -%}
                     <var>{{ vars[forloop.index0] }}</var>
                     {%- if item != "1" -%}
                        {%- include lu-math/exponent.html exponent=item %}
                     {%- endif -%}
                  {%- endif -%}
               {%- endfor -%}
            {%- endfor -%}
         </lu-math-part>
         <lu-math-raw-endcap> </lu-math-raw-endcap>
      </lu-math-row>
   </lu-math>
</section>

<section>
   <h2><a name="conclusion"></a>Conclusion</h2>
   <p>
      This overall process can be followed for a multinomial of any size <lu-math data-inline><var>m</var></lu-math>, being raised to any exponent <lu-math data-inline><var>n</var></lu-math>. You want to create a table like the ones above, listing out every combination of <lu-math data-inline><var>m</var></lu-math> many numbers (each between 0 and <lu-math data-inline><var>n</var></lu-math>) that add up to <lu-math data-inline><var>n</var></lu-math>. You can then mimic the process above, and get your result.
   </p>
</section>