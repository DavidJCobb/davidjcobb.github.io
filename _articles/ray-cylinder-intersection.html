---
title: Ray/cylinder intersections
tags:
 - 3D
 - geometry
 - intersection
 - math
 - raycasting
social_media:
   description: The math behind doing raycasts for 3D cylinder. Includes public-domain code.
extra_css_files:
 - lu-math.css
   
---
{%- include lu-math/defines.html -%}
<section>
   <p>
      There are a lot of people out on the web who are willing to share raycasting code, 
      but not a whole lot of them bother to actually apply a permissive license to it so 
      that people can legally use it. What's more, a lot of them don't explain how they 
      actually derived the math involved either.
   </p>
   <p>
      Here, I'm going to walk through how to put together a ray/cylinder intersection test. 
      I've also provided code at the bottom as a public domain work.
   </p>
</section>

<section>
   <h2><a name="parametric"></a>Parametric surface of a cylinder</h2>
   <p>
      The parametric equations (that is, equations with parameters) for a cylinder are as follows:
   </p>
   <lu-math>
      <lu-math-givens>
         <label>Given:</label>
         <dl>
            <lu-math-dfn>
               <dt><var>C<sub>h</sub></var></dt>
               <dd>height of the cylinder</dd>
            </lu-math-dfn>
            <lu-math-dfn>
               <dt><var>C<sub>r</sub></var></dt>
               <dd>radius of the cylinder</dd>
            </lu-math-dfn>
            <lu-math-dfn>
               <dt><var>H<sub>o</sub></var></dt>
               <dd>height offset on the range [0, <var>C<sub>h</sub></var>], where 0 is aligned with an endcap</dd>
            </lu-math-dfn>
            <lu-math-dfn>
               <dt><var>&theta;</var></dt>
               <dd>any angle, basically</dd>
            </lu-math-dfn>
         </dl>
      </lu-math-givens>
      <lu-math-aligned data-equation-number="1">
         {%- assign common_args = "<var>H<sub>o</sub></var>, <var>&theta;</var>" | split: ", " -%}
         <lu-math-row>
            <lu-math-part>
               {%- include lu-math/function-def.html
                  name="f<sub><var>x</var></sub>"
                  args=common_args
               %}
               =
            </lu-math-part>
            <lu-math-part>
               <var>C<sub>r</sub></var> &times; cos(<var>&theta;</var>)<!--
         --></lu-math-part>
         </lu-math-row>
         <lu-math-row>
            <lu-math-part>
               {%- include lu-math/function-def.html
                  name="f<sub><var>y</var></sub>"
                  args=common_args
               %}
               =
            </lu-math-part>
            <lu-math-part>
               <var>C<sub>r</sub></var> &times; sin(<var>&theta;</var>)<!--
         --></lu-math-part>
         </lu-math-row>
         <lu-math-row>
            <lu-math-part>
               {%- include lu-math/function-def.html
                  name="f<sub><var>z</var></sub>"
                  args=common_args
               %}
               =
            </lu-math-part>
            <lu-math-part><!--
            --><var>H<sub>o</sub></var><!--
         --></lu-math-part>
         </lu-math-row>
      </lu-math-aligned>
   </lu-math>
   <p>
      Technically, these equations describe an infinite cylinder &mdash; one with no endcaps, which extends forever in both directions. However, we can still use them to put together the tests for a finite clinder with endcaps.
   </p>
   <p>
      You may notice that these are very similar to the parametric equations <a href="{% link _articles/ray-cone-intersection.html %}">for a cone</a>. Mathematically speaking, a cylinder is basically a cone with infinite height, and geometrically speaking, a cylinder is just a cone that never tapers. Moreover, if we ignore the Z-component, then we're literally just writing the equation for a 2D circle.
   </p>
</section>

<section>
   <h2><a name="implicit">Implicit surface of a cylinder</a></h2>
   <p>
      We have a <dfn>parametric surface</dfn> &mdash; that is, three parametric equations which define all points on the surface of the cylinder. In order to solve for any given part of the equation, however, we need an <dfn>implicit surface</dfn>: a surface defined by a single equation, wherein <lu-math data-inline><var>x</var></lu-math>, <lu-math data-inline><var>y</var></lu-math>, and <lu-math data-inline><var>z</var></lu-math> are on one side, and 0 is on the other side.
   </p>
   <p>
      The above equations basically define a 2D circle anchored at <lu-math data-inline>(0, 0)</lu-math> on the XY-plane, and then extend it infinitely along the Z-axis. The circle's radius is <lu-math data-inline><var>C<sub>r</sub></var></lu-math>. This means that we can represent the X and Y equations in terms of any arbitrary 2D vector <lu-math data-inline><var>P<sub>2D</sub></var></lu-math>:
   </p>
   <lu-math data-equation-number="2">
      ||<var>P<sub>2D</sub></var>||<!--
   -->&nbsp;=&nbsp;<!--
   --><var>C<sub>r</sub></var>
   </lu-math>
   <p>
      If we project a 3D vector <lu-math data-inline><var>P</var></lu-math> onto the Z-axis, then we'll have just its Z-component. Remove that component, and we can then fit it into the equation above.
   </p>
   <lu-math>
      <lu-math-givens>
         <label>Given:</label>
         <dl>
            <lu-math-dfn>
               <dt><var>P</var></dt>
               <dd>any point on the curved surface of the infinite cylinder</dd>
            </lu-math-dfn>
            <lu-math-dfn>
               <dt><var>C<sub>a</sub></var></dt>
               <dd>axis of the cylinder; in this case, (0, 0, 1)</dd>
            </lu-math-dfn>
            <lu-math-dfn>
               <dt><var>P<sub>s</sub></var></dt>
               <dd><var>P</var> projected onto <var>C<sub>a</sub></var></dd>
            </lu-math-dfn>
         </dl>
      </lu-math-givens>
      <lu-math-row>
         <var>P<sub>s</sub></var>
          = 
         (<var>P</var> &bullet; <var>C<sub>a</sub></var>)
          &times;
         <var>C<sub>a</sub></var>
      </lu-math-row>
      <lu-math-row data-equation-number="3">
         ||<var>P</var> - <var>P<sub>s</sub></var>||
          =&nbsp;
         <var>C<sub>r</sub></var>
      </lu-math-row>
   </lu-math>
   <p>
      If we so desire, we can now subtract <var>C<sub>r</sub></var> from both sides of the equation in order to have one side contain only zero. As such, this is now an implicit surface, which defines a cylinder that has one endcap centered on <lu-math data-inline>(0, 0, 0)</lu-math>.
   </p>
</section>

<section>
   <h2><a name="transformed">Handling a translated and rotated cylinder</a></h2>
   <p>
      In general, we'll want to run raycasts against a bounded cylinder &mdash; one with endcaps, rather than one that extends infinitely along its axis. There's no equation that can represent a bounded cylinder directly. However, we can still represent an infinite cylinder in terms of where the endcaps <em>would</em> be, and then use some distance checks later to enforce bounds.
   </p>
   <p>
      Let's take the implicit surface of an infinite cylinder, and represent it in terms of the endcaps.
   </p>
   <lu-math>
      <lu-math-givens>
         <label>Given:</label>
         <dl>
            <lu-math-dfn>
               <dt><var>C<sub>b</sub></var></dt>
               <dd>centerpoint of the cylinder's bottom endcap</dd>
            </lu-math-dfn>
            <lu-math-dfn>
               <dt><var>C<sub>t</sub></var></dt>
               <dd>centerpoint of the cylinder's top endcap</dd>
            </lu-math-dfn>
            <lu-math-dfn>
               <dt><var>C<sub>s</sub></var></dt>
               <dd>"spine" of the cylinder: a vector from the top to the bottom, equal to <var>C<sub>t</sub></var> - <var>C<sub>b</sub></var></dd>
            </lu-math-dfn>
            <lu-math-dfn>
               <dt><var>C<sub>a</sub></var></dt>
               <dd>axis of the cylinder: normalized spine</dd>
            </lu-math-dfn>
            <lu-math-dfn>
               <dt><var>H<sub>p</sub></var></dt>
               <dd>hit position: a point that we presume is on the cylinder's curved surface</dd>
            </lu-math-dfn>
            <lu-math-dfn>
               <dt><var>H<sub>s</sub></var></dt>
               <dd>hit spine position: the hit position projected onto <var>C<sub>s</sub></var>; this position = ((<var>H<sub>p</sub></var> - <var>C<sub>b</sub></var>) &bullet; <var>C<sub>a</sub></var>)<var>C<sub>a</sub></var> + <var>C<sub>b</sub></var></dd>
            </lu-math-dfn>
            <lu-math-dfn>
               <dt><var>H<sub>o</sub></var></dt>
               <dd>the height offset from our cylinder equations; this is the distance from <var>H<sub>s</sub></var> to <var>C<sub>b</sub></var> i.e. ||<var>H<sub>s</sub></var> - <var>C<sub>b</sub></var>||.</dd>
            </lu-math-dfn>
         </dl>
      </lu-math-givens>
   </lu-math>
   <p>
      <lu-math data-inline><var>H<sub>p</sub></var></lu-math> fills the role of <lu-math data-inline><var>P</var></lu-math> in Equation 3, and <lu-math data-inline><var>H<sub>s</sub></var></lu-math> fills the role of <lu-math data-inline><var>P<sub>p</sub></var></lu-math>. <lu-math data-inline><var>H<sub>s</sub></var></lu-math> is the hit position projected onto the cylinder's axis &mdash; its "spine." If we view the cylinder from its endcap, then <lu-math data-inline><var>H<sub>s</sub></var></lu-math> will be at the center of a circle; if <lu-math data-inline><var>H<sub>p</sub></var></lu-math> is indeed on the cylinder's curved surface, then the distance from it to <lu-math data-inline><var>H<sub>s</sub></var></lu-math> will equal tthe cylinder's radius:
   </p>
   <lu-math>
      <lu-math-row>
         ||<var>H<sub>p</sub></var> - <var>H<sub>s</sub></var>||
          =&nbsp;
         <var>C<sub>r</sub></var>
      </lu-math-row>
   </lu-math>
   <p>
      We want to expand <lu-math data-inline><var>H<sub>s</sub></var></lu-math> at this point, but there are actually two ways to do that. We can expand it in terms of <lu-math data-inline><var>C<sub>a</sub></var></lu-math>, or in terms of <lu-math data-inline><var>C<sub>s</sub></var></lu-math>. Now, as it happens, I've tried <lu-math data-inline><var>C<sub>a</sub></var></lu-math>, and the end result (once I started solving for the ray) was an incredibly complex quadratic equation &mdash; completely unwieldy. So let's try <lu-math data-inline><var>C<sub>s</sub></var></lu-math> instead.
   </p>
   <lu-math>
      <lu-math-row data-equation-number="4">
         ||<var>H<sub>p</sub></var> - 
         ((<var>H<sub>p</sub></var> - <var>C<sub>b</sub></var>) &bullet; <var>C<sub>a</sub></var>)<var>C<sub>a</sub></var>
         + <var>C<sub>b</sub></var>||
          =&nbsp;
         <var>C<sub>r</sub></var>
      </lu-math-row>
   </lu-math>
</section>

<section>
   <h2><a name="solving">Solving for the ray</a></h2>
   <p>
      A ray is commonly defined in terms of a starting point, or <dfn>origin</dfn>, and a normalized direction vector. We can therefore define the hit position in terms of the same.
   </p>
   <lu-math>
      <lu-math-givens>
         <label>Given:</label>
         <dl>
            <lu-math-dfn>
               <dt><var>R<sub>o</sub></var></dt>
               <dd>the ray's origin</dd>
            </lu-math-dfn>
            <lu-math-dfn>
               <dt><var>R<sub>d</sub></var></dt>
               <dd>the ray's direction</dd>
            </lu-math-dfn>
            <lu-math-dfn>
               <dt><var>H<sub>p</sub></var></dt>
               <dd>the position at which the ray hits some surface</dd>
            </lu-math-dfn>
            <lu-math-dfn>
               <dt><var>H<sub>d</sub></var></dt>
               <dd>the hit distance: the distance from the ray origin to the hit position</dd>
            </lu-math-dfn>
         </dl>
      </lu-math-givens>
      <lu-math-row>
         <var>H<sub>p</sub></var><!--
      -->&nbsp;=&nbsp;<!--
      --><var>R<sub>o</sub></var> + <var>R<sub>d</sub></var><var>H<sub>d</sub></var>
      </lu-math-row>
   </lu-math>
   <p>
      We can substitute this equation into our cone equation above, and then attempt to solve for the hit distance <lu-math data-inline><var>H<sub>d</sub></var></lu-math>:
   </p>
   <lu-math>
      <lu-math-row>
         ||<mark><var>R<sub>o</sub></var> + <var>R<sub>d</sub></var><var>H<sub>d</sub></var></mark> - 
         ((<mark><var>R<sub>o</sub></var> + <var>R<sub>d</sub></var><var>H<sub>d</sub></var></mark> - <var>C<sub>b</sub></var>) &bullet; <var>C<sub>a</sub></var>)<var>C<sub>a</sub></var>
         + <var>C<sub>b</sub></var>||
          =&nbsp;
         <var>C<sub>r</sub></var>
      </lu-math-row>
   </lu-math>
   <p>
      Now, we want to pull <lu-math data-inline><var>H<sub>d</sub></var></lu-math> out of that fraction. The first thing we can do is rearrange the nearby dot product. Dot products are commutative in exactly the same ways that scalar multiplications are, so...
   </p>
   <lu-math>
      <lu-math-row>
         ||<var>R<sub>o</sub></var> + <var>R<sub>d</sub></var><var>H<sub>d</sub></var> - 
         (<mark>(<var>R<sub>o</sub></var> &bullet; <var>C<sub>a</sub></var>)
       + (<var>R<sub>d</sub></var> &bullet; <var>C<sub>a</sub></var>)<var>H<sub>d</sub></var>
       - (<var>C<sub>b</sub></var> &bullet; <var>C<sub>a</sub></var>)</mark>)<var>C<sub>a</sub></var>
         + <var>C<sub>b</sub></var>||
          =&nbsp;
         <var>C<sub>r</sub></var>
      </lu-math-row>
   </lu-math>
   <p>
      The dot product of a vector with itself is the vector's own length squared. This means that we can square both sides to turn our lefthand side into a dot product. Then, we can expand it.
   </p>
   <lu-math data-enormous-rows>
      <lu-math-row>
         ||<var>R<sub>o</sub></var> + <var>R<sub>d</sub></var><var>H<sub>d</sub></var> - 
         ((<var>R<sub>o</sub></var> &bullet; <var>C<sub>a</sub></var>)
       + (<var>R<sub>d</sub></var> &bullet; <var>C<sub>a</sub></var>)<var>H<sub>d</sub></var>
       - (<var>C<sub>b</sub></var> &bullet; <var>C<sub>a</sub></var>))<var>C<sub>a</sub></var>
         + <var>C<sub>b</sub></var>||<mark>{{lu_math_sq}}</mark>
          =&nbsp;
         <var>C<sub>r</sub></var><mark>{{lu_math_sq}}</mark>
      </lu-math-row>
      <lu-math-row>
         <lu-math-multiline>
            <lu-math-body>
               <lu-math-line>
                  (<var>R<sub>o</sub></var> + <var>R<sub>d</sub></var><var>H<sub>d</sub></var> - 
                  ((<var>R<sub>o</sub></var> &bullet; <var>C<sub>a</sub></var>)
                + (<var>R<sub>d</sub></var> &bullet; <var>C<sub>a</sub></var>)<var>H<sub>d</sub></var>
                - (<var>C<sub>b</sub></var> &bullet; <var>C<sub>a</sub></var>))<var>C<sub>a</sub></var>
                  + <var>C<sub>b</sub></var>)
               </lu-math-line>
               <lu-math-sep><mark> + </mark></lu-math-sep>
               <lu-math-line>
                  <mark>(<var>R<sub>o</sub></var> + <var>R<sub>d</sub></var><var>H<sub>d</sub></var> - 
                  ((<var>R<sub>o</sub></var> &bullet; <var>C<sub>a</sub></var>)
                + (<var>R<sub>d</sub></var> &bullet; <var>C<sub>a</sub></var>)<var>H<sub>d</sub></var>
                - (<var>C<sub>b</sub></var> &bullet; <var>C<sub>a</sub></var>))<var>C<sub>a</sub></var>
                  + <var>C<sub>b</sub></var>)</mark>
               </lu-math-line>
            </lu-math-body>
            <lu-math-trailing>
               =&nbsp;<nobr><var>C<sub>r</sub></var>{{lu_math_sq}}</nobr>
            </lu-math-trailing>
         </lu-math-multiline>
      </lu-math-row>
   </lu-math>
   <p>
      Now, again, dot products are commutative in the same ways that scalar multiplications are. This means that the following rule works for both scalar variables and vector variables:
   </p>
   <lu-math>
      <lu-math-row>
         (<var>a</var> + <var>b</var> + <var>c</var> + <var>d</var>){{lu_math_sq}}
         =
         <var>a</var>{{lu_math_sq}}
       + <var>b</var>{{lu_math_sq}}
       + <var>c</var>{{lu_math_sq}}
       + <var>d</var>{{lu_math_sq}}
       + 2<var>a</var><var>b</var>
       + 2<var>a</var><var>c</var>
       + 2<var>a</var><var>d</var>
       + 2<var>b</var><var>c</var>
       + 2<var>b</var><var>d</var>
       + 2<var>c</var><var>d</var>
      </lu-math-row>
   </lu-math>
   <p>
      Let's fill in our variables.
   </p>
   <lu-math>
      <lu-math-givens>
         <label>Given (just for now):</label>
         <dl>
            <lu-math-dfn>
               <dt><var>a</var></dt>
               <dd><var>R<sub>o</sub></var></dd>
            </lu-math-dfn>
            <lu-math-dfn>
               <dt><var>b</var></dt>
               <dd><var>R<sub>d</sub></var><var>H<sub>d</sub></var></dd>
            </lu-math-dfn>
            <lu-math-dfn>
               <dt><var>c</var></dt>
               <dd>
                  -(<!--
                  -->(<var>R<sub>o</sub></var> &bullet; <var>C<sub>a</sub></var>)
                   + (<var>R<sub>d</sub></var> &bullet; <var>C<sub>a</sub></var>)<var>H<sub>d</sub></var>
                   - (<var>C<sub>b</sub></var> &bullet; <var>C<sub>a</sub></var>)<!--
               -->)<var>C<sub>a</sub></var>
               </dd>
            </lu-math-dfn>
            <lu-math-dfn>
               <dt><var>d</var></dt>
               <dd><var>C<sub>b</sub></var></dd>
            </lu-math-dfn>
         </dl>
      </lu-math-givens>
      <lu-math-row>
         <lu-math-multiline>
            <lu-math-body>
               <lu-math-line>
                  <mark class="mark-1"><var>R<sub>o</sub></var></mark>{{lu_math_sq}}
               </lu-math-line>
               <lu-math-sep> + </lu-math-sep>
               <lu-math-line>
                  <mark class="mark-2"><var>R<sub>d</sub></var></mark>{{lu_math_sq}}<mark class="mark-2"><var>H<sub>d</sub></var></mark>{{lu_math_sq}}
               </lu-math-line>
               <lu-math-sep> + </lu-math-sep>
               <lu-math-line>
                  <mark class="mark-3">((<!--
         -->(<var>R<sub>o</sub></var> &bullet; <var>C<sub>a</sub></var>)
          + (<var>R<sub>d</sub></var> &bullet; <var>C<sub>a</sub></var>)<var>H<sub>d</sub></var>
          - (<var>C<sub>b</sub></var> &bullet; <var>C<sub>a</sub></var>)<!--
      -->)<var>C<sub>a</sub></var>)</mark>{{lu_math_sq}}
               </lu-math-line>
               <lu-math-sep> + </lu-math-sep>
               <lu-math-line>
                  <mark class="mark-4"><var>C<sub>b</sub></var></mark>{{lu_math_sq}}
               </lu-math-line>
               <lu-math-sep> + </lu-math-sep>
               <lu-math-line>
                  2<mark class="mark-1"><var>R<sub>o</sub></var></mark><mark class="mark-2"><var>R<sub>d</sub></var><var>H<sub>d</sub></var></mark>
               </lu-math-line>
               <lu-math-sep><mark class="mark-3"> - </mark></lu-math-sep>
               <lu-math-line>
                  2<mark class="mark-1"><var>R<sub>o</sub></var></mark><!--
               --><mark class="mark-3">(<!--
                  -->(<var>R<sub>o</sub></var> &bullet; <var>C<sub>a</sub></var>)
                   + (<var>R<sub>d</sub></var> &bullet; <var>C<sub>a</sub></var>)<var>H<sub>d</sub></var>
                   - (<var>C<sub>b</sub></var> &bullet; <var>C<sub>a</sub></var>)<!--
               -->)<var>C<sub>a</sub></var></mark>
               </lu-math-line>
               <lu-math-sep> + </lu-math-sep>
               <lu-math-line>
                  2<mark class="mark-1"><var>R<sub>o</sub></var></mark><mark class="mark-4"><var>C<sub>b</sub></var></mark>
               </lu-math-line>
               <lu-math-sep><mark class="mark-3"> - </mark></lu-math-sep>
               <lu-math-line>
                  2<mark class="mark-2"><var>R<sub>d</sub></var><var>H<sub>d</sub></var></mark><mark class="mark-3">(<!--
            -->(<var>R<sub>o</sub></var> &bullet; <var>C<sub>a</sub></var>)
             + (<var>R<sub>d</sub></var> &bullet; <var>C<sub>a</sub></var>)<var>H<sub>d</sub></var>
             - (<var>C<sub>b</sub></var> &bullet; <var>C<sub>a</sub></var>)<!--
         -->)<var>C<sub>a</sub></var></mark>
               </lu-math-line>
               <lu-math-sep> + </lu-math-sep>
               <lu-math-line>
                  2<mark class="mark-2"><var>R<sub>d</sub></var><var>H<sub>d</sub></var></mark><mark class="mark-4"><var>C<sub>b</sub></var></mark>
               </lu-math-line>
               <lu-math-sep><mark class="mark-3"> - </mark></lu-math-sep>
               <lu-math-line>
                  2<!--
               --><mark class="mark-3">(<!--
                  -->(<var>R<sub>o</sub></var> &bullet; <var>C<sub>a</sub></var>)
                   + (<var>R<sub>d</sub></var> &bullet; <var>C<sub>a</sub></var>)<var>H<sub>d</sub></var>
                   - (<var>C<sub>b</sub></var> &bullet; <var>C<sub>a</sub></var>)<!--
               -->)<var>C<sub>a</sub></var></mark><mark class="mark-4"><var>C<sub>b</sub></var></mark>
               </lu-math-line>
            </lu-math-body>
         </lu-math-multiline>
      </lu-math-row>
   </lu-math>
   <p>
      <lu-math data-inline>
         ((<var>R<sub>o</sub></var> &bullet; <var>C<sub>a</sub></var>)
       + (<var>R<sub>d</sub></var> &bullet; <var>C<sub>a</sub></var>)<var>H<sub>d</sub></var>
       - (<var>C<sub>b</sub></var> &bullet; <var>C<sub>a</sub></var>)) &bullet; <var>C<sub>a</sub></var>
       </lu-math> is the projection of the ray onto the cylinder's axis; therefore, 
       <lu-math data-inline>
         (<var>R<sub>o</sub></var> &bullet; <var>C<sub>a</sub></var>)
       + (<var>R<sub>d</sub></var> &bullet; <var>C<sub>a</sub></var>)<var>H<sub>d</sub></var>
       - (<var>C<sub>b</sub></var> &bullet; <var>C<sub>a</sub></var>)
       </lu-math> is the length of that projection. Squaring the projection pretty much just means taking the dot product of the projection with itself &mdash; taking its length &mdash; so we can remove the multiplication by <lu-math data-inline><var>C<sub>a</sub></var></lu-math> in that first squared term. We can also convert the other squared vectors into dot products.
   </p>
   <lu-math data-enormous-rows>
      <lu-math-row>
         <lu-math-multiline>
            <lu-math-body>
               <lu-math-line>
                  <var>R<sub>o</sub></var>{{lu_math_sq}}
               </lu-math-line>
               <lu-math-sep> + </lu-math-sep>
               <lu-math-line>
                  <var>R<sub>d</sub></var>{{lu_math_sq}}<var>H<sub>d</sub></var>{{lu_math_sq}}
               </lu-math-line>
               <lu-math-sep> + </lu-math-sep>
               <lu-math-line>
                  <mark>(<!--
         -->(<var>R<sub>o</sub></var> &bullet; <var>C<sub>a</sub></var>)
          + (<var>R<sub>d</sub></var> &bullet; <var>C<sub>a</sub></var>)<var>H<sub>d</sub></var>
          - (<var>C<sub>b</sub></var> &bullet; <var>C<sub>a</sub></var>)<!--
      -->)</mark>{{lu_math_sq}}
               </lu-math-line>
               <lu-math-sep> + </lu-math-sep>
               <lu-math-line>
                  <var>C<sub>b</sub></var>{{lu_math_sq}}
               </lu-math-line>
               <lu-math-sep> + </lu-math-sep>
               <lu-math-line>
                  2<var>R<sub>o</sub></var><var>R<sub>d</sub></var><var>H<sub>d</sub></var>
               </lu-math-line>
               <lu-math-sep> - </lu-math-sep>
               <lu-math-line>
                  2<var>R<sub>o</sub></var><!--
               -->(<!--
                  -->(<var>R<sub>o</sub></var> &bullet; <var>C<sub>a</sub></var>)
                   + (<var>R<sub>d</sub></var> &bullet; <var>C<sub>a</sub></var>)<var>H<sub>d</sub></var>
                   - (<var>C<sub>b</sub></var> &bullet; <var>C<sub>a</sub></var>)<!--
               -->)<var>C<sub>a</sub></var>
               </lu-math-line>
               <lu-math-sep> + </lu-math-sep>
               <lu-math-line>
                  2<var>R<sub>o</sub></var><var>C<sub>b</sub></var>
               </lu-math-line>
               <lu-math-sep> - </lu-math-sep>
               <lu-math-line>
                  2<var>R<sub>d</sub></var><var>H<sub>d</sub></var>(<!--
            -->(<var>R<sub>o</sub></var> &bullet; <var>C<sub>a</sub></var>)
             + (<var>R<sub>d</sub></var> &bullet; <var>C<sub>a</sub></var>)<var>H<sub>d</sub></var>
             - (<var>C<sub>b</sub></var> &bullet; <var>C<sub>a</sub></var>)<!--
         -->)<var>C<sub>a</sub></var>
               </lu-math-line>
               <lu-math-sep> + </lu-math-sep>
               <lu-math-line>
                  2<var>R<sub>d</sub></var><var>H<sub>d</sub></var><var>C<sub>b</sub></var>
               </lu-math-line>
               <lu-math-sep> - </lu-math-sep>
               <lu-math-line>
                  2<!--
               -->(<!--
                  -->(<var>R<sub>o</sub></var> &bullet; <var>C<sub>a</sub></var>)
                   + (<var>R<sub>d</sub></var> &bullet; <var>C<sub>a</sub></var>)<var>H<sub>d</sub></var>
                   - (<var>C<sub>b</sub></var> &bullet; <var>C<sub>a</sub></var>)<!--
               -->)<var>C<sub>a</sub></var><var>C<sub>b</sub></var>
               </lu-math-line>
            </lu-math-body>
         </lu-math-multiline>
      </lu-math-row>
      <lu-math-row>
         <lu-math-multiline>
            <lu-math-body>
               <lu-math-line>
                  <mark>(<var>R<sub>o</sub></var> &bullet; <var>R<sub>o</sub></var>)</mark>
               </lu-math-line>
               <lu-math-sep> + </lu-math-sep>
               <lu-math-line>
                  <mark>(<var>R<sub>d</sub></var> &bullet; <var>R<sub>d</sub></var>)</mark><var>H<sub>d</sub></var>{{lu_math_sq}}
               </lu-math-line>
               <lu-math-sep> + </lu-math-sep>
               <lu-math-line>
                  <mark>(<!--
         -->(<var>R<sub>o</sub></var> &bullet; <var>C<sub>a</sub></var>)
          + (<var>R<sub>d</sub></var> &bullet; <var>C<sub>a</sub></var>)<var>H<sub>d</sub></var>
          - (<var>C<sub>b</sub></var> &bullet; <var>C<sub>a</sub></var>)<!--
      -->)</mark>{{lu_math_sq}}
               </lu-math-line>
               <lu-math-sep> + </lu-math-sep>
               <lu-math-line>
                  <mark>(<var>C<sub>b</sub></var> &bullet; <var>C<sub>b</sub></var>)</mark>
               </lu-math-line>
               <lu-math-sep> + </lu-math-sep>
               <lu-math-line>
                  2<var>R<sub>o</sub></var><var>R<sub>d</sub></var><var>H<sub>d</sub></var>
               </lu-math-line>
               <lu-math-sep> - </lu-math-sep>
               <lu-math-line>
                  2<var>R<sub>o</sub></var><!--
               -->(<!--
                  -->(<var>R<sub>o</sub></var> &bullet; <var>C<sub>a</sub></var>)
                   + (<var>R<sub>d</sub></var> &bullet; <var>C<sub>a</sub></var>)<var>H<sub>d</sub></var>
                   - (<var>C<sub>b</sub></var> &bullet; <var>C<sub>a</sub></var>)<!--
               -->)<var>C<sub>a</sub></var>
               </lu-math-line>
               <lu-math-sep> + </lu-math-sep>
               <lu-math-line>
                  2<var>R<sub>o</sub></var><var>C<sub>b</sub></var>
               </lu-math-line>
               <lu-math-sep> - </lu-math-sep>
               <lu-math-line>
                  2<var>R<sub>d</sub></var><var>H<sub>d</sub></var>(<!--
            -->(<var>R<sub>o</sub></var> &bullet; <var>C<sub>a</sub></var>)
             + (<var>R<sub>d</sub></var> &bullet; <var>C<sub>a</sub></var>)<var>H<sub>d</sub></var>
             - (<var>C<sub>b</sub></var> &bullet; <var>C<sub>a</sub></var>)<!--
         -->)<var>C<sub>a</sub></var>
               </lu-math-line>
               <lu-math-sep> + </lu-math-sep>
               <lu-math-line>
                  2<var>R<sub>d</sub></var><var>H<sub>d</sub></var><var>C<sub>b</sub></var>
               </lu-math-line>
               <lu-math-sep> - </lu-math-sep>
               <lu-math-line>
                  2<!--
               -->(<!--
                  -->(<var>R<sub>o</sub></var> &bullet; <var>C<sub>a</sub></var>)
                   + (<var>R<sub>d</sub></var> &bullet; <var>C<sub>a</sub></var>)<var>H<sub>d</sub></var>
                   - (<var>C<sub>b</sub></var> &bullet; <var>C<sub>a</sub></var>)<!--
               -->)<var>C<sub>a</sub></var><var>C<sub>b</sub></var>
               </lu-math-line>
            </lu-math-body>
         </lu-math-multiline>
      </lu-math-row>
   </lu-math>
   <p>
      Let's group our terms by <lu-math data-inline><var>H<sub>d</sub></var></lu-math>:
   </p>
   <lu-math>
      <lu-math-row>
         <lu-math-multiline>
            <lu-math-body>
               <lu-math-line>
                  (<var>R<sub>d</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>H<sub>d</sub></var>{{lu_math_sq}} + (<var>R<sub>o</sub></var> &bullet; <var>R<sub>o</sub></var>)
               </lu-math-line>
               <lu-math-sep> + </lu-math-sep>
               <lu-math-line>
                  (<!--
         -->(<var>R<sub>o</sub></var> &bullet; <var>C<sub>a</sub></var>)
          + (<var>R<sub>d</sub></var> &bullet; <var>C<sub>a</sub></var>)<var>H<sub>d</sub></var>
          - (<var>C<sub>b</sub></var> &bullet; <var>C<sub>a</sub></var>)<!--
      -->){{lu_math_sq}}
               </lu-math-line>
               <lu-math-sep> - </lu-math-sep>
               <lu-math-line>
                  2<var>R<sub>o</sub></var><!--
               -->(<!--
                  -->(<var>R<sub>o</sub></var> &bullet; <var>C<sub>a</sub></var>)
                   + (<var>R<sub>d</sub></var> &bullet; <var>C<sub>a</sub></var>)<var>H<sub>d</sub></var>
                   - (<var>C<sub>b</sub></var> &bullet; <var>C<sub>a</sub></var>)<!--
               -->)<var>C<sub>a</sub></var>
               </lu-math-line>
               <lu-math-sep> - </lu-math-sep>
               <lu-math-line>
                  2<var>R<sub>d</sub></var><var>H<sub>d</sub></var>(<!--
            -->(<var>R<sub>o</sub></var> &bullet; <var>C<sub>a</sub></var>)
             + (<var>R<sub>d</sub></var> &bullet; <var>C<sub>a</sub></var>)<var>H<sub>d</sub></var>
             - (<var>C<sub>b</sub></var> &bullet; <var>C<sub>a</sub></var>)<!--
         -->)<var>C<sub>a</sub></var>
               </lu-math-line>
               <lu-math-sep> - </lu-math-sep>
               <lu-math-line>
                  2<!--
               -->(<!--
                  -->(<var>R<sub>o</sub></var> &bullet; <var>C<sub>a</sub></var>)
                   + (<var>R<sub>d</sub></var> &bullet; <var>C<sub>a</sub></var>)<var>H<sub>d</sub></var>
                   - (<var>C<sub>b</sub></var> &bullet; <var>C<sub>a</sub></var>)<!--
               -->)<var>C<sub>a</sub></var><var>C<sub>b</sub></var>
               </lu-math-line>
               <lu-math-sep> + </lu-math-sep>
               <lu-math-line>
                  2(
                     <var>R<sub>o</sub></var><var>R<sub>d</sub></var>
                   + <var>R<sub>d</sub></var><var>C<sub>b</sub></var>
                  )<var>H<sub>d</sub></var>
               </lu-math-line>
               <lu-math-sep> + </lu-math-sep>
               <lu-math-line>
                  (<var>C<sub>b</sub></var> &bullet; <var>C<sub>b</sub></var>)
               </lu-math-line>
               <lu-math-sep> + </lu-math-sep>
               <lu-math-line>
                  2<var>R<sub>o</sub></var><var>C<sub>b</sub></var>
               </lu-math-line>
            </lu-math-body>
         </lu-math-multiline>
      </lu-math-row>
   </lu-math>
   
   
   <p>
      Let's give ourselves another variable to work with.
   </p>
   <lu-math>
      <lu-math-row>
         <lu-math-part>
            ||<var>R<sub>o</sub></var> + <var>R<sub>d</sub></var><var>H<sub>d</sub></var> - 
         </lu-math-part>
         <lu-math-fraction>
            <lu-math-raw>(</lu-math-raw>
            <lu-math-numer>(<mark><var>R<sub>l</sub></var></mark> + <var>R<sub>d</sub></var><var>H<sub>d</sub></var>) &bullet; <var>C<sub>s</sub></var></lu-math-numer>
            <lu-math-raw>) &divide; (</lu-math-raw>
            <lu-math-denom><var>C<sub>s</sub></var> &bullet; <var>C<sub>s</sub></var></lu-math-denom>
            <lu-math-raw>)</lu-math-raw><!--
      --></lu-math-fraction><!--
      --><lu-math-part>
            <lu-math-raw> &times; </lu-math-raw>
            <var>C<sub>s</sub></var>
            + <var>C<sub>b</sub></var>||
             =&nbsp;
            <var>C<sub>r</sub></var>
         </lu-math-part>
      </lu-math-row>
   </lu-math>
   <p>
      Now, let's try something.
   </p>
   <lu-math>
      <lu-math-row>
         <lu-math-part>
            ||<var>A</var> + <var>B</var> + 
         </lu-math-part>
         <lu-math-fraction>
            <lu-math-raw>(</lu-math-raw>
            <lu-math-numer><var>C</var></lu-math-numer>
            <lu-math-raw>) &divide; (</lu-math-raw>
            <lu-math-denom><var>n</var></lu-math-denom>
            <lu-math-raw>)</lu-math-raw><!--
      --></lu-math-fraction>
         <lu-math-part>
            + <var>D</var>|| = <var>D</var>
         </lu-math-part>
      </lu-math-row>
      <lu-math-row>
         <lu-math-part>
            (<var>A</var> + <var>B</var> + 
         </lu-math-part>
         <lu-math-fraction>
            <lu-math-raw>(</lu-math-raw>
            <lu-math-numer><var>C</var></lu-math-numer>
            <lu-math-raw>) &divide; (</lu-math-raw>
            <lu-math-denom><var>n</var></lu-math-denom>
            <lu-math-raw>)</lu-math-raw><!--
      --></lu-math-fraction>
         <lu-math-part>
            + <var>D</var>) &bullet; (<var>A</var> + <var>B</var> + 
         </lu-math-part>
         <lu-math-fraction>
            <lu-math-raw>(</lu-math-raw>
            <lu-math-numer><var>C</var></lu-math-numer>
            <lu-math-raw>) &divide; (</lu-math-raw>
            <lu-math-denom><var>n</var></lu-math-denom>
            <lu-math-raw>)</lu-math-raw><!--
      --></lu-math-fraction>
         <lu-math-part>
            + <var>D</var>) = <var>D</var>{{lu_math_sq}}
         </lu-math-part>
      </lu-math-row>
   </lu-math>
   
   
   
   
   <p>
      The dot product of a vector with itself is equal to the length squared. If we square both sides, then we can convert the lefthand side to a dot product:
   </p>
   <lu-math>
      <lu-math-row>
         ||<var>R<sub>o</sub></var> + <var>R<sub>d</sub></var><var>H<sub>d</sub></var> - ((<var>R<sub>o</sub></var> + <var>R<sub>d</sub></var><var>H<sub>d</sub></var> - <var>C<sub>b</sub></var>) &bullet; <var>C<sub>a</sub></var>)<var>C<sub>a</sub></var> + <var>C<sub>b</sub></var>||{{ lu_math_sq }}
          = 
         <var>C<sub>r</sub></var>{{ lu_math_sq }}
      </lu-math-row>
      <lu-math-row data-equation-number="5">
         (<var>R<sub>o</sub></var> + <var>R<sub>d</sub></var><var>H<sub>d</sub></var> - ((<var>R<sub>o</sub></var> + <var>R<sub>d</sub></var><var>H<sub>d</sub></var> - <var>C<sub>b</sub></var>) &bullet; <var>C<sub>a</sub></var>)<var>C<sub>a</sub></var> + <var>C<sub>b</sub></var>)
          &bullet;
         (<var>R<sub>o</sub></var> + <var>R<sub>d</sub></var><var>H<sub>d</sub></var> - ((<var>R<sub>o</sub></var> + <var>R<sub>d</sub></var><var>H<sub>d</sub></var> - <var>C<sub>b</sub></var>) &bullet; <var>C<sub>a</sub></var>)<var>C<sub>a</sub></var> + <var>C<sub>b</sub></var>)
          = 
         <var>C<sub>r</sub></var>{{ lu_math_sq }}
      </lu-math-row>
   </lu-math>
   <p>
      We want to get <lu-math data-inline><var>H<sub>d</sub></var></lu-math> outside of that inner expression. If we expand that inner dot product, then we can rearrange it &mdash; separate <lu-math data-inline><var>H<sub>d</sub></var></lu-math> out, and then recombine the rest back into dot product operations.
   </p>
   <lu-math>
      <lu-math-row>
         (<var>R<sub>o</sub></var> + <var>R<sub>d</sub></var><var>H<sub>d</sub></var> - ((<var>R<sub>o</sub></var> + <var>R<sub>d</sub></var><var>H<sub>d</sub></var> - <var>C<sub>b</sub></var>) &bullet; <var>C<sub>a</sub></var>)<var>C<sub>a</sub></var> + <var>C<sub>b</sub></var>)
      </lu-math-row>
      <lu-math-row>
         (<var>R<sub>o</sub></var> + <var>R<sub>d</sub></var><var>H<sub>d</sub></var> - (<!--
         --><mark class="mark-1"><var>C<sub>ax</sub></var><var>R<sub>ox</sub></var> + <var>C<sub>ax</sub></var><var>R<sub>dx</sub></var><var>H<sub>d</sub></var> - <var>C<sub>ax</sub></var><var>C<sub>bx</sub></var></mark>
          + <mark class="mark-2"><var>C<sub>ay</sub></var><var>R<sub>oy</sub></var> + <var>C<sub>ay</sub></var><var>R<sub>dy</sub></var><var>H<sub>d</sub></var> - <var>C<sub>ay</sub></var><var>C<sub>by</sub></var></mark>
          + <mark class="mark-3"><var>C<sub>az</sub></var><var>R<sub>oz</sub></var> + <var>C<sub>az</sub></var><var>R<sub>dz</sub></var><var>H<sub>d</sub></var> - <var>C<sub>az</sub></var><var>C<sub>bz</sub></var></mark><!--
      -->)<var>C<sub>a</sub></var> + <var>C<sub>b</sub></var>)
      </lu-math-row>
      <lu-math-row>
         (<var>R<sub>o</sub></var> + <var>R<sub>d</sub></var><var>H<sub>d</sub></var> - (<!--
         --><mark>(<!--
            --><var>C<sub>ax</sub></var><var>R<sub>dx</sub></var>
             + <var>C<sub>ay</sub></var><var>R<sub>dy</sub></var>
             + <var>C<sub>az</sub></var><var>R<sub>dz</sub></var><!--
         -->)<var>H<sub>d</sub></var></mark>
          + <var>C<sub>ax</sub></var><var>R<sub>ox</sub></var>
          + <var>C<sub>ay</sub></var><var>R<sub>oy</sub></var>
          + <var>C<sub>az</sub></var><var>R<sub>oz</sub></var>
          - <var>C<sub>ax</sub></var><var>C<sub>bx</sub></var>
          - <var>C<sub>ay</sub></var><var>C<sub>by</sub></var>
          - <var>C<sub>az</sub></var><var>C<sub>bz</sub></var><!--
      -->)<var>C<sub>a</sub></var> + <var>C<sub>b</sub></var>)
      </lu-math-row>
      <lu-math-row>
         (<var>R<sub>o</sub></var> + <var>R<sub>d</sub></var><var>H<sub>d</sub></var> - (<!--
         --><mark class="mark-1">(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)</mark><var>H<sub>d</sub></var>
          + <mark class="mark-2">(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)</mark>
          - <mark class="mark-3">(</mark><!--
            --><var>C<sub>ax</sub></var><var>C<sub>bx</sub></var>
               <mark class="mark-3">+</mark>
               <var>C<sub>ay</sub></var><var>C<sub>by</sub></var>
               <mark class="mark-3">+</mark>
               <var>C<sub>az</sub></var><var>C<sub>bz</sub></var><!--
         --><mark class="mark-3">)</mark><!--
      -->)<var>C<sub>a</sub></var> + <var>C<sub>b</sub></var>)
      </lu-math-row>
      <lu-math-row>
         (<var>R<sub>o</sub></var> + <var>R<sub>d</sub></var><var>H<sub>d</sub></var> - (<!--
         -->(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>H<sub>d</sub></var>
          + (<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)
          - (<mark class="mark-3"><var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var></mark>)<!--
      -->)<var>C<sub>a</sub></var> + <var>C<sub>b</sub></var>)
      </lu-math-row>
      <lu-math-row>
         (<var>R<sub>o</sub></var> + <var>R<sub>d</sub></var><var>H<sub>d</sub></var>
          - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<mark class="mark-1"><var>C<sub>a</sub></var></mark><var>H<sub>d</sub></var>
          <mark class="mark-2">-</mark> (<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<mark class="mark-1"><var>C<sub>a</sub></var></mark>
          <mark class="mark-2">+</mark> (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<mark class="mark-1"><var>C<sub>a</sub></var></mark><!--
      --> + <var>C<sub>b</sub></var>)
      </lu-math-row>
   </lu-math>
   <p>
      Now let's group the terms by <lu-math data-inline><var>H<sub>d</sub></var></lu-math>:
   </p>
   <lu-math>
      <lu-math-row>
         (<!--
      --><mark>(<!--
         --><var>R<sub>d</sub></var>
          - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>a</sub></var><!--
      -->)</mark><var>H<sub>d</sub></var>
          + <var>R<sub>o</sub></var>
          - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>a</sub></var>
          + (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>a</sub></var><!--
      --> + <var>C<sub>b</sub></var><!--
      -->)
      </lu-math-row>
   </lu-math>
   <p>
      Let's substitute that back into Equation 5:
   </p>
   <lu-math>
      <lu-math-row data-equation-number="6">
         (<!--
         -->(<!--
            --><var>R<sub>d</sub></var>
             - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>a</sub></var><!--
         -->)<var>H<sub>d</sub></var>
             + <var>R<sub>o</sub></var>
             - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>a</sub></var>
             + (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>a</sub></var><!--
         --> + <var>C<sub>b</sub></var><!--
      -->)
          &bullet;
         (<!--
         -->(<!--
            --><var>R<sub>d</sub></var>
             - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>a</sub></var><!--
         -->)<var>H<sub>d</sub></var>
             + <var>R<sub>o</sub></var>
             - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>a</sub></var>
             + (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>a</sub></var><!--
         --> + <var>C<sub>b</sub></var><!--
      -->)
          = 
         <var>C<sub>r</sub></var>{{ lu_math_sq }}
      </lu-math-row>
   </lu-math>
   <p>
      Now, we're gonna have to expand the dot product in full. That said, we don't have to expand any of the inner, nested, dot products.
   </p>
   <lu-math>
      <lu-math-row>
         <mark class="mark-1">(<!--
         -->(<!--
            --><var>R<sub>dx</sub></var>
             - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var><!--
         -->)<var>H<sub>d</sub></var>
             + <var>R<sub>ox</sub></var>
             - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ax</sub></var>
             + (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var><!--
         --> + <var>C<sub>bx</sub></var><!--
      -->)
         &times;
         (<!--
         -->(<!--
            --><var>R<sub>dx</sub></var>
             - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var><!--
         -->)<var>H<sub>d</sub></var>
             + <var>R<sub>ox</sub></var>
             - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ax</sub></var>
             + (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var><!--
         --> + <var>C<sub>bx</sub></var><!--
      -->)</mark>
         +
         <mark class="mark-2">(<!--
         -->(<!--
            --><var>R<sub>dy</sub></var>
             - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var><!--
         -->)<var>H<sub>d</sub></var>
             + <var>R<sub>oy</sub></var>
             - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ay</sub></var>
             + (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ay</sub></var><!--
         --> + <var>C<sub>by</sub></var><!--
      -->)
         &times;
         (<!--
         -->(<!--
            --><var>R<sub>dy</sub></var>
             - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var><!--
         -->)<var>H<sub>d</sub></var>
             + <var>R<sub>oy</sub></var>
             - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ay</sub></var>
             + (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ay</sub></var><!--
         --> + <var>C<sub>by</sub></var><!--
      -->)</mark>
         +
         <mark class="mark-3">(<!--
         -->(<!--
            --><var>R<sub>dz</sub></var>
             - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var><!--
         -->)<var>H<sub>d</sub></var>
             + <var>R<sub>oz</sub></var>
             - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>az</sub></var>
             + (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>az</sub></var><!--
         --> + <var>C<sub>bz</sub></var><!--
      -->)
         &times;
         (<!--
         -->(<!--
            --><var>R<sub>dz</sub></var>
             - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var><!--
         -->)<var>H<sub>d</sub></var>
             + <var>R<sub>oz</sub></var>
             - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>az</sub></var>
             + (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>az</sub></var><!--
         --> + <var>C<sub>bz</sub></var><!--
      -->)</mark>
          = 
         <var>C<sub>r</sub></var>{{ lu_math_sq }}
      </lu-math-row>
   </lu-math>
   <p>
      Each axis is a six-term multinomial multiplied by itself. That is, it takes the following form:
   </p>
   <lu-math>
      <lu-math-row>
         (<var>a</var> + <var>b</var> + <var>c</var> + <var>d</var> + <var>e</var> + <var>f</var>){{lu_math_sq}}
      </lu-math-row>
   </lu-math>
   <p>
      During an earlier, failed, attempt at working on this whole thing, I figured out how to expand any multinomial raised to any exponent. I wrote about it <a href="{% link _articles/multinomial-theorem.html %}">in another article</a>, but the short version is that we want this:
   </p>
   <lu-math data-enormous-rows>
      <lu-math-row>
         <var>a</var>{{ lu_math_sq }} + 
         <var>b</var>{{ lu_math_sq }} + 
         <var>c</var>{{ lu_math_sq }} + 
         <var>d</var>{{ lu_math_sq }} + 
         <var>e</var>{{ lu_math_sq }} + 
         <var>f</var>{{ lu_math_sq }} +
         2<var>a</var><var>b</var> +
         2<var>a</var><var>c</var> +
         2<var>a</var><var>d</var> +
         2<var>a</var><var>e</var> +
         2<var>a</var><var>f</var> +
         2<var>b</var><var>c</var> +
         2<var>b</var><var>d</var> +
         2<var>b</var><var>e</var> +
         2<var>b</var><var>f</var> +
         2<var>c</var><var>d</var> +
         2<var>c</var><var>e</var> +
         2<var>c</var><var>f</var> +
         2<var>d</var><var>e</var> +
         2<var>d</var><var>f</var> +
         2<var>e</var><var>f</var>
      </lu-math-row>
   </lu-math>
   <p>
      Let's expand just the x-axis this way, to keep things at least slightly manageable:
   </p>
   <lu-math>
      <lu-math-row>
         (<!--
         -->(<!--
            --><mark class="mark-1"><var>R<sub>dx</sub></var></mark>
             <mark class="mark-2">- (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var><!--
         -->)<var>H<sub>d</sub></var></mark>
             + <mark class="mark-3"><var>R<sub>ox</sub></var></mark>
             <mark class="mark-4">- (<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ax</sub></var></mark>
             + <mark class="mark-5">(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var></mark>
             + <mark class="mark-6"><var>C<sub>bx</sub></var></mark><!--
      -->)
         &times;
         (<!--
         -->(<!--
            --><var>R<sub>dx</sub></var>
             - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var><!--
         -->)<var>H<sub>d</sub></var>
             + <var>R<sub>ox</sub></var>
             - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ax</sub></var>
             + (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var><!--
         --> + <var>C<sub>bx</sub></var><!--
      -->)
      </lu-math-row>
      {%- comment -%}
         B and D are negative.
      {%- endcomment -%}
      {%- capture a_pos -%}<mark class="mark-1"><var>R<sub>dx</sub></var></mark>{%- endcapture -%}
      {%- capture b_pos -%}<mark class="mark-2">((<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var>)<var>H<sub>d</sub></var>)</mark>{%- endcapture -%}
      {%- capture c_pos -%}<mark class="mark-3"><var>R<sub>ox</sub></var></mark>{%- endcapture -%}
      {%- capture d_pos -%}<mark class="mark-4">((<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ax</sub></var>)</mark>{%- endcapture -%}
      {%- capture e_pos -%}<mark class="mark-5">((<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var>)</mark>{%- endcapture -%}
      {%- capture f_pos -%}<mark class="mark-6"><var>C<sub>bx</sub></var></mark>{%- endcapture -%}
      <lu-math-row>
         {{a_pos}}{{ lu_math_sq }}
          + {{b_pos}}{{ lu_math_sq }} 
          + {{c_pos}}{{ lu_math_sq }} 
          + {{d_pos}}{{ lu_math_sq }} 
          + {{e_pos}}{{ lu_math_sq }} 
          + {{f_pos}}{{ lu_math_sq }}
          - 2{{a_pos}}{{b_pos}}
          + 2{{a_pos}}{{c_pos}}
          - 2{{a_pos}}{{d_pos}}
          + 2{{a_pos}}{{e_pos}}
          + 2{{a_pos}}{{f_pos}}
          - 2{{b_pos}}{{c_pos}}
          + 2{{b_pos}}{{d_pos}}
          - 2{{b_pos}}{{e_pos}}
          - 2{{b_pos}}{{f_pos}}
          + 2{{c_pos}}{{d_pos}}
          + 2{{c_pos}}{{e_pos}}
          + 2{{c_pos}}{{f_pos}}
          - 2{{d_pos}}{{e_pos}}
          - 2{{d_pos}}{{f_pos}}
          + 2{{e_pos}}{{f_pos}}
      </lu-math-row>
   </lu-math>
   <p>
      Let's group the terms by <lu-math data-inline><var>H<sub>d</sub></var></lu-math>:
   </p>
   <lu-math data-enormous-rows>
      <lu-math-row>
         <var>R<sub>dx</sub></var>{{ lu_math_sq }}
          + ((<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var>)<var>H<sub>d</sub></var>){{ lu_math_sq }} 
          + <var>R<sub>ox</sub></var>{{ lu_math_sq }} 
          + ((<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ax</sub></var>){{ lu_math_sq }} 
          + ((<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var>){{ lu_math_sq }} 
          + <var>C<sub>bx</sub></var>{{ lu_math_sq }}
          - 2<var>R<sub>dx</sub></var>((<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var>)<var>H<sub>d</sub></var>)
          + 2<var>R<sub>dx</sub></var><var>R<sub>ox</sub></var>
          - 2<var>R<sub>dx</sub></var>((<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ax</sub></var>)
          + 2<var>R<sub>dx</sub></var>((<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var>)
          + 2<var>R<sub>dx</sub></var><var>C<sub>bx</sub></var>
          - 2((<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var>)<var>H<sub>d</sub></var>)<var>R<sub>ox</sub></var>
          + 2((<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var>)<var>H<sub>d</sub></var>)((<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ax</sub></var>)
          - 2((<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var>)<var>H<sub>d</sub></var>)((<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var>)
          - 2((<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var>)<var>H<sub>d</sub></var>)<var>C<sub>bx</sub></var>
          + 2<var>R<sub>ox</sub></var>((<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ax</sub></var>)
          + 2<var>R<sub>ox</sub></var>((<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var>)
          + 2<var>R<sub>ox</sub></var><var>C<sub>bx</sub></var>
          - 2((<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ax</sub></var>)((<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var>)
          - 2((<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ax</sub></var>)<var>C<sub>bx</sub></var>
          + 2((<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var>)<var>C<sub>bx</sub></var>
      </lu-math-row>
      <lu-math-row>
         (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var>){{ lu_math_sq }}<var>H<sub>d</sub></var>{{lu_math_sq}}
         
          - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var><var>R<sub>dx</sub></var><var>H<sub>d</sub></var>
          - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var><var>R<sub>ox</sub></var><var>H<sub>d</sub></var>
          
          + 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ax</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var><var>H<sub>d</sub></var>
          - 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var><var>H<sub>d</sub></var>
          
          - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var><var>C<sub>bx</sub></var><var>H<sub>d</sub></var>
          
          + 2<var>R<sub>dx</sub></var><var>R<sub>ox</sub></var>
          - 2<var>R<sub>dx</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ax</sub></var>
          + 2<var>R<sub>dx</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var>
          + 2<var>R<sub>ox</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ax</sub></var>
          + 2<var>R<sub>ox</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var>
          - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ax</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var>
          - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ax</sub></var><var>C<sub>bx</sub></var>
          + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var><var>C<sub>bx</sub></var>
          
          + 2<var>R<sub>dx</sub></var><var>C<sub>bx</sub></var>
          + 2<var>R<sub>ox</sub></var><var>C<sub>bx</sub></var>
          
          + ((<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ax</sub></var>){{ lu_math_sq }} 
          + ((<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var>){{ lu_math_sq }} 
          
          + <var>R<sub>dx</sub></var>{{ lu_math_sq }}
          + <var>R<sub>ox</sub></var>{{ lu_math_sq }} 
          + <var>C<sub>bx</sub></var>{{ lu_math_sq }}
      </lu-math-row>
      <lu-math-row>
         (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var>){{ lu_math_sq }}<var>H<sub>d</sub></var>{{lu_math_sq}}
         + <mark>2(<!--
         -->(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ax</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var>
          - (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var>
          - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var><var>C<sub>bx</sub></var>
          - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var><var>R<sub>dx</sub></var>
          - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var><var>R<sub>ox</sub></var><!--
         -->)</mark><var>H<sub>d</sub></var>
          
          - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ax</sub></var><var>R<sub>dx</sub></var>
          + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var><var>R<sub>dx</sub></var>
          + 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ax</sub></var><var>R<sub>ox</sub></var>
          + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var><var>R<sub>ox</sub></var>
          - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var>{{lu_math_sq}}
          - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ax</sub></var><var>C<sub>bx</sub></var>
          + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var><var>C<sub>bx</sub></var>
          
          + 2<var>R<sub>dx</sub></var><var>R<sub>ox</sub></var>
          + 2<var>R<sub>dx</sub></var><var>C<sub>bx</sub></var>
          + 2<var>R<sub>ox</sub></var><var>C<sub>bx</sub></var>
          
          + ((<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ax</sub></var>){{ lu_math_sq }} 
          + ((<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var>){{ lu_math_sq }} 
          
          + <var>R<sub>dx</sub></var>{{ lu_math_sq }}
          + <var>R<sub>ox</sub></var>{{ lu_math_sq }} 
          + <var>C<sub>bx</sub></var>{{ lu_math_sq }}
      </lu-math-row>
   </lu-math>
   <p>
      Let's add the other axes back in:
   </p>
   <lu-math>
      <lu-math-row>
         <mark class="mark-1">(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var>){{ lu_math_sq }}<var>H<sub>d</sub></var>{{lu_math_sq}}
         + 2(<!--
         -->(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ax</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var>
          - (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var>
          - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var><var>C<sub>bx</sub></var>
          - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var><var>R<sub>dx</sub></var>
          - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var><var>R<sub>ox</sub></var><!--
         -->)<var>H<sub>d</sub></var>
          
          - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ax</sub></var><var>R<sub>dx</sub></var>
          + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var><var>R<sub>dx</sub></var>
          + 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ax</sub></var><var>R<sub>ox</sub></var>
          + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var><var>R<sub>ox</sub></var>
          - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var>{{lu_math_sq}}
          - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ax</sub></var><var>C<sub>bx</sub></var>
          + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var><var>C<sub>bx</sub></var>
          
          + 2<var>R<sub>dx</sub></var><var>R<sub>ox</sub></var>
          + 2<var>R<sub>dx</sub></var><var>C<sub>bx</sub></var>
          + 2<var>R<sub>ox</sub></var><var>C<sub>bx</sub></var>
          
          + ((<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ax</sub></var>){{ lu_math_sq }} 
          + ((<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var>){{ lu_math_sq }} 
          
          + <var>R<sub>dx</sub></var>{{ lu_math_sq }}
          + <var>R<sub>ox</sub></var>{{ lu_math_sq }} 
          + <var>C<sub>bx</sub></var>{{ lu_math_sq }}</mark>
         
          +
          
         <mark class="mark-2">(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var>){{ lu_math_sq }}<var>H<sub>d</sub></var>{{lu_math_sq}}
         + 2(<!--
         -->(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ay</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var>
          - (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ay</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var>
          - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var><var>C<sub>by</sub></var>
          - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var><var>R<sub>dy</sub></var>
          - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var><var>R<sub>oy</sub></var><!--
         -->)<var>H<sub>d</sub></var>
          
          - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ay</sub></var><var>R<sub>dy</sub></var>
          + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ay</sub></var><var>R<sub>dy</sub></var>
          + 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ay</sub></var><var>R<sub>oy</sub></var>
          + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ay</sub></var><var>R<sub>oy</sub></var>
          - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ay</sub></var>{{lu_math_sq}}
          - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ay</sub></var><var>C<sub>by</sub></var>
          + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ay</sub></var><var>C<sub>by</sub></var>
          
          + 2<var>R<sub>dy</sub></var><var>R<sub>oy</sub></var>
          + 2<var>R<sub>dy</sub></var><var>C<sub>by</sub></var>
          + 2<var>R<sub>oy</sub></var><var>C<sub>by</sub></var>
          
          + ((<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ay</sub></var>){{ lu_math_sq }} 
          + ((<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ay</sub></var>){{ lu_math_sq }} 
          
          + <var>R<sub>dy</sub></var>{{ lu_math_sq }}
          + <var>R<sub>oy</sub></var>{{ lu_math_sq }} 
          + <var>C<sub>by</sub></var>{{ lu_math_sq }}</mark>
         
          +
          
         <mark class="mark-3">(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var>){{ lu_math_sq }}<var>H<sub>d</sub></var>{{lu_math_sq}}
         + 2(<!--
         -->(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>az</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var>
          - (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>az</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var>
          - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var><var>C<sub>bz</sub></var>
          - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var><var>R<sub>dz</sub></var>
          - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var><var>R<sub>oz</sub></var><!--
         -->)<var>H<sub>d</sub></var>
          
          - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>az</sub></var><var>R<sub>dz</sub></var>
          + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>az</sub></var><var>R<sub>dz</sub></var>
          + 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>az</sub></var><var>R<sub>oz</sub></var>
          + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>az</sub></var><var>R<sub>oz</sub></var>
          - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>az</sub></var>{{lu_math_sq}}
          - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>az</sub></var><var>C<sub>bz</sub></var>
          + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>az</sub></var><var>C<sub>bz</sub></var>
          
          + 2<var>R<sub>dz</sub></var><var>R<sub>oz</sub></var>
          + 2<var>R<sub>dz</sub></var><var>C<sub>bz</sub></var>
          + 2<var>R<sub>oz</sub></var><var>C<sub>bz</sub></var>
          
          + ((<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>az</sub></var>){{ lu_math_sq }} 
          + ((<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>az</sub></var>){{ lu_math_sq }} 
          
          + <var>R<sub>dz</sub></var>{{ lu_math_sq }}
          + <var>R<sub>oz</sub></var>{{ lu_math_sq }} 
          + <var>C<sub>bz</sub></var>{{ lu_math_sq }}</mark>
      </lu-math-row>
   </lu-math>
   <p>
      Let's group by <lu-math data-inline><var>H<sub>d</sub></var></lu-math> again, and then move common terms from different axes right next to each other.
   </p>
   <lu-math data-enormous-rows>
      <lu-math-row>
         <mark>(
            ((<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var>){{ lu_math_sq }}
          + ((<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var>){{ lu_math_sq }}
          + ((<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var>){{ lu_math_sq }}
         )</mark><var>H<sub>d</sub></var>{{lu_math_sq}}
         +
         <mark>(
            2(<!--
            -->(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ax</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var>
             - (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var>
             - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var><var>C<sub>bx</sub></var>
             - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var><var>R<sub>dx</sub></var>
             - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var><var>R<sub>ox</sub></var><!--
         -->)
            +
            2(<!--
            -->(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ay</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var>
             - (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ay</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var>
             - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var><var>C<sub>by</sub></var>
             - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var><var>R<sub>dy</sub></var>
             - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var><var>R<sub>oy</sub></var><!--
         -->)
            +
            2(<!--
            -->(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>az</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var>
             - (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>az</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var>
             - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var><var>C<sub>bz</sub></var>
             - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var><var>R<sub>dz</sub></var>
             - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var><var>R<sub>oz</sub></var><!--
         -->)
         )</mark><var>H<sub>d</sub></var>
      
          - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ax</sub></var><var>R<sub>dx</sub></var>
          + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var><var>R<sub>dx</sub></var>
          + 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ax</sub></var><var>R<sub>ox</sub></var>
          + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var><var>R<sub>ox</sub></var>
          - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var>{{lu_math_sq}}
          - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ax</sub></var><var>C<sub>bx</sub></var>
          + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var><var>C<sub>bx</sub></var>
          
          + 2<var>R<sub>dx</sub></var><var>R<sub>ox</sub></var>
          + 2<var>R<sub>dx</sub></var><var>C<sub>bx</sub></var>
          + 2<var>R<sub>ox</sub></var><var>C<sub>bx</sub></var>
          
          + ((<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ax</sub></var>){{ lu_math_sq }} 
          + ((<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var>){{ lu_math_sq }} 
          
          + <var>R<sub>dx</sub></var>{{ lu_math_sq }}
          + <var>R<sub>ox</sub></var>{{ lu_math_sq }} 
          + <var>C<sub>bx</sub></var>{{ lu_math_sq }}
         
          - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ay</sub></var><var>R<sub>dy</sub></var>
          + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ay</sub></var><var>R<sub>dy</sub></var>
          + 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ay</sub></var><var>R<sub>oy</sub></var>
          + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ay</sub></var><var>R<sub>oy</sub></var>
          - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ay</sub></var>{{lu_math_sq}}
          - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ay</sub></var><var>C<sub>by</sub></var>
          + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ay</sub></var><var>C<sub>by</sub></var>
          
          + 2<var>R<sub>dy</sub></var><var>R<sub>oy</sub></var>
          + 2<var>R<sub>dy</sub></var><var>C<sub>by</sub></var>
          + 2<var>R<sub>oy</sub></var><var>C<sub>by</sub></var>
          
          + ((<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ay</sub></var>){{ lu_math_sq }} 
          + ((<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ay</sub></var>){{ lu_math_sq }} 
          
          + <var>R<sub>dy</sub></var>{{ lu_math_sq }}
          + <var>R<sub>oy</sub></var>{{ lu_math_sq }} 
          + <var>C<sub>by</sub></var>{{ lu_math_sq }}
         
          - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>az</sub></var><var>R<sub>dz</sub></var>
          + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>az</sub></var><var>R<sub>dz</sub></var>
          + 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>az</sub></var><var>R<sub>oz</sub></var>
          + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>az</sub></var><var>R<sub>oz</sub></var>
          - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>az</sub></var>{{lu_math_sq}}
          - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>az</sub></var><var>C<sub>bz</sub></var>
          + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>az</sub></var><var>C<sub>bz</sub></var>
          
          + 2<var>R<sub>dz</sub></var><var>R<sub>oz</sub></var>
          + 2<var>R<sub>dz</sub></var><var>C<sub>bz</sub></var>
          + 2<var>R<sub>oz</sub></var><var>C<sub>bz</sub></var>
          
          + ((<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>az</sub></var>){{ lu_math_sq }} 
          + ((<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>az</sub></var>){{ lu_math_sq }} 
          
          + <var>R<sub>dz</sub></var>{{ lu_math_sq }}
          + <var>R<sub>oz</sub></var>{{ lu_math_sq }} 
          + <var>C<sub>bz</sub></var>{{ lu_math_sq }}
      </lu-math-row>
      <lu-math-row>
         <lu-math-row-chunk>
            (<!--
            -->((<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var>){{ lu_math_sq }}
             + ((<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var>){{ lu_math_sq }}
             + ((<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var>){{ lu_math_sq }}<!--
         -->)<var>H<sub>d</sub></var>{{lu_math_sq}}
         </lu-math-row-chunk>
         <lu-math-row-chunk>
            +
            (<!--
            -->2(<!--
               -->(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ax</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var><var>C<sub>bx</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var><var>R<sub>dx</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var><var>R<sub>ox</sub></var><!--
            -->)
               +
               2(<!--
               -->(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ay</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ay</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var><var>C<sub>by</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var><var>R<sub>dy</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var><var>R<sub>oy</sub></var><!--
            -->)
               +
               2(<!--
               -->(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>az</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>az</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var><var>C<sub>bz</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var><var>R<sub>dz</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var><var>R<sub>oz</sub></var><!--
            -->)<!--
         -->)<var>H<sub>d</sub></var>
         </lu-math-row-chunk>
         <lu-math-row-chunk>
          - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ax</sub></var><var>R<sub>dx</sub></var>
          - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ay</sub></var><var>R<sub>dy</sub></var>
          - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>az</sub></var><var>R<sub>dz</sub></var>
         </lu-math-row-chunk>
          
         <lu-math-row-chunk>
          + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var><var>R<sub>dx</sub></var>
          + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ay</sub></var><var>R<sub>dy</sub></var>
          + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>az</sub></var><var>R<sub>dz</sub></var>
         </lu-math-row-chunk>
          
         <lu-math-row-chunk>
          + 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ax</sub></var><var>R<sub>ox</sub></var>
          + 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ay</sub></var><var>R<sub>oy</sub></var>
          + 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>az</sub></var><var>R<sub>oz</sub></var>
         </lu-math-row-chunk>
          
         <lu-math-row-chunk>
          + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var><var>R<sub>ox</sub></var>
          + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ay</sub></var><var>R<sub>oy</sub></var>
          + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>az</sub></var><var>R<sub>oz</sub></var>
         </lu-math-row-chunk>
          
         <lu-math-row-chunk>
          - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var>{{lu_math_sq}}
          - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ay</sub></var>{{lu_math_sq}}
          - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>az</sub></var>{{lu_math_sq}}
         </lu-math-row-chunk>
          
         <lu-math-row-chunk>
          - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ax</sub></var><var>C<sub>bx</sub></var>
          - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ay</sub></var><var>C<sub>by</sub></var>
          - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>az</sub></var><var>C<sub>bz</sub></var>
         </lu-math-row-chunk>
          
         <lu-math-row-chunk>
          + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var><var>C<sub>bx</sub></var>
          + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ay</sub></var><var>C<sub>by</sub></var>
          + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>az</sub></var><var>C<sub>bz</sub></var>
         </lu-math-row-chunk>
          
         <lu-math-row-chunk>
          + 2<var>R<sub>dx</sub></var><var>R<sub>ox</sub></var>
          + 2<var>R<sub>dy</sub></var><var>R<sub>oy</sub></var>
          + 2<var>R<sub>dz</sub></var><var>R<sub>oz</sub></var>
         </lu-math-row-chunk>
          
         <lu-math-row-chunk>
          + 2<var>R<sub>dx</sub></var><var>C<sub>bx</sub></var>
          + 2<var>R<sub>dy</sub></var><var>C<sub>by</sub></var>
          + 2<var>R<sub>dz</sub></var><var>C<sub>bz</sub></var>
         </lu-math-row-chunk>
          
         <lu-math-row-chunk>
          + 2<var>R<sub>ox</sub></var><var>C<sub>bx</sub></var>
          + 2<var>R<sub>oy</sub></var><var>C<sub>by</sub></var>
          + 2<var>R<sub>oz</sub></var><var>C<sub>bz</sub></var>
         </lu-math-row-chunk>
          
         <lu-math-row-chunk>
          + ((<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ax</sub></var>){{ lu_math_sq }}
          + ((<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ay</sub></var>){{ lu_math_sq }}
          + ((<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>az</sub></var>){{ lu_math_sq }}
         </lu-math-row-chunk>
          
         <lu-math-row-chunk>
          + ((<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var>){{ lu_math_sq }}
          + ((<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ay</sub></var>){{ lu_math_sq }}
          + ((<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>az</sub></var>){{ lu_math_sq }}
         </lu-math-row-chunk>
          
         <lu-math-row-chunk>
          + <var>R<sub>dx</sub></var>{{ lu_math_sq }}
          + <var>R<sub>dy</sub></var>{{ lu_math_sq }}
          + <var>R<sub>dz</sub></var>{{ lu_math_sq }}
         </lu-math-row-chunk>
          
         <lu-math-row-chunk>
          + <var>R<sub>ox</sub></var>{{ lu_math_sq }}
          + <var>R<sub>oy</sub></var>{{ lu_math_sq }}
          + <var>R<sub>oz</sub></var>{{ lu_math_sq }}
         </lu-math-row-chunk>
          
         <lu-math-row-chunk>
          + <var>C<sub>bx</sub></var>{{ lu_math_sq }}
          + <var>C<sub>by</sub></var>{{ lu_math_sq }}
          + <var>C<sub>bz</sub></var>{{ lu_math_sq }}
         </lu-math-row-chunk>
      </lu-math-row>
   </lu-math>
   <p>
      Now, it's trivial to merge components back into their original vectors.
   </p>
   <lu-math data-enormous-rows>
      <lu-math-row>
         <lu-math-row-chunk>
            (<!--
            -->((<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var>){{ lu_math_sq }}
             + ((<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var>){{ lu_math_sq }}
             + ((<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var>){{ lu_math_sq }}<!--
         -->)<var>H<sub>d</sub></var>{{lu_math_sq}}
         </lu-math-row-chunk>
         <lu-math-row-chunk>
            +
            (<!--
            -->2(<!--
               -->(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ax</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var><var>C<sub>bx</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var><var>R<sub>dx</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var><var>R<sub>ox</sub></var><!--
            -->)
               +
               2(<!--
               -->(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ay</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ay</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var><var>C<sub>by</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var><var>R<sub>dy</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var><var>R<sub>oy</sub></var><!--
            -->)
               +
               2(<!--
               -->(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>az</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>az</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var><var>C<sub>bz</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var><var>R<sub>dz</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var><var>R<sub>oz</sub></var><!--
            -->)<!--
         -->)<var>H<sub>d</sub></var>
         </lu-math-row-chunk>
         
         <lu-math-row-chunk>
            -
            <mark class="mark-1">
               2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)
            </mark>
         </lu-math-row-chunk>
          
         <lu-math-row-chunk>
            +
            <mark class="mark-2">
               2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)
            </mark>
         </lu-math-row-chunk>
          
         <lu-math-row-chunk>
            +
            <mark class="mark-3">
               2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)
            </mark>
         </lu-math-row-chunk>
          
         <lu-math-row-chunk>
            +
            <mark class="mark-4">
               2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)
            </mark>
         </lu-math-row-chunk>
          
         <lu-math-row-chunk>
            -
            <mark class="mark-5">
               2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>a</sub></var>)
            </mark>
         </lu-math-row-chunk>
          
         <lu-math-row-chunk>
            -
            <mark class="mark-6">
               2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)
            </mark>
         </lu-math-row-chunk>
          
         <lu-math-row-chunk>
            +
            <mark class="mark-1">
               2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)
            </mark>
         </lu-math-row-chunk>
          
         <lu-math-row-chunk>
            +
            <mark class="mark-2">
               2(<var>R<sub>d</sub></var> &bullet; <var>R<sub>o</sub></var>)
            </mark>
         </lu-math-row-chunk>
          
         <lu-math-row-chunk>
            +
            <mark class="mark-3">
               2(<var>R<sub>d</sub></var> &bullet; <var>C<sub>b</sub></var>)
            </mark>
         </lu-math-row-chunk>
          
         <lu-math-row-chunk>
            +
            <mark class="mark-4">
               2(<var>R<sub>o</sub></var> &bullet; <var>C<sub>b</sub></var>)
            </mark>
         </lu-math-row-chunk>
          
         <lu-math-row-chunk>
          + ((<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ax</sub></var>){{ lu_math_sq }}
          + ((<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ay</sub></var>){{ lu_math_sq }}
          + ((<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>az</sub></var>){{ lu_math_sq }}
         </lu-math-row-chunk>
          
         <lu-math-row-chunk>
          + ((<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var>){{ lu_math_sq }}
          + ((<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ay</sub></var>){{ lu_math_sq }}
          + ((<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>az</sub></var>){{ lu_math_sq }}
         </lu-math-row-chunk>
          
         <lu-math-row-chunk>
          + <var>R<sub>dx</sub></var>{{ lu_math_sq }}
          + <var>R<sub>dy</sub></var>{{ lu_math_sq }}
          + <var>R<sub>dz</sub></var>{{ lu_math_sq }}
         </lu-math-row-chunk>
          
         <lu-math-row-chunk>
          + <var>R<sub>ox</sub></var>{{ lu_math_sq }}
          + <var>R<sub>oy</sub></var>{{ lu_math_sq }}
          + <var>R<sub>oz</sub></var>{{ lu_math_sq }}
         </lu-math-row-chunk>
          
         <lu-math-row-chunk>
          + <var>C<sub>bx</sub></var>{{ lu_math_sq }}
          + <var>C<sub>by</sub></var>{{ lu_math_sq }}
          + <var>C<sub>bz</sub></var>{{ lu_math_sq }}
         </lu-math-row-chunk>
      </lu-math-row>
      <lu-math-row>
         <lu-math-row-chunk>
            (<!--
            -->((<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var>){{ lu_math_sq }}
             + ((<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var>){{ lu_math_sq }}
             + ((<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var>){{ lu_math_sq }}<!--
         -->)<var>H<sub>d</sub></var>{{lu_math_sq}}
         </lu-math-row-chunk>
         <lu-math-row-chunk>
            +
            (<!--
            -->2(<!--
               -->(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ax</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var><var>C<sub>bx</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var><var>R<sub>dx</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var><var>R<sub>ox</sub></var><!--
            -->)
               +
               2(<!--
               -->(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ay</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ay</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var><var>C<sub>by</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var><var>R<sub>dy</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var><var>R<sub>oy</sub></var><!--
            -->)
               +
               2(<!--
               -->(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>az</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>az</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var><var>C<sub>bz</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var><var>R<sub>dz</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var><var>R<sub>oz</sub></var><!--
            -->)<!--
         -->)<var>H<sub>d</sub></var>
         </lu-math-row-chunk>
         
         <lu-math-row-chunk>
            - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)
            + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)
            + 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)
            + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)
            - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>a</sub></var>)
            - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)
            + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)
            + 2(<var>R<sub>d</sub></var> &bullet; <var>R<sub>o</sub></var>)
            + 2(<var>R<sub>d</sub></var> &bullet; <var>C<sub>b</sub></var>)
            + 2(<var>R<sub>o</sub></var> &bullet; <var>C<sub>b</sub></var>)
         </lu-math-row-chunk>
          
         <lu-math-row-chunk>
          + ((<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ax</sub></var>)<mark class="mark-1">((<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ax</sub></var>)</mark>
          + ((<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ay</sub></var>)<mark class="mark-1">((<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ay</sub></var>)</mark>
          + ((<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>az</sub></var>)<mark class="mark-1">((<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>az</sub></var>)</mark>
         </lu-math-row-chunk>
          
         <lu-math-row-chunk>
          + ((<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var>)<mark class="mark-1">((<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var>)</mark>
          + ((<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ay</sub></var>)<mark class="mark-1">((<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ay</sub></var>)</mark>
          + ((<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>az</sub></var>)<mark class="mark-1">((<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>az</sub></var>)</mark>
         </lu-math-row-chunk>
          
         <lu-math-row-chunk>
            + <mark class="mark-2">(<var>R<sub>d</sub></var> &bullet; <var>R<sub>d</sub></var>)</mark>
         </lu-math-row-chunk>
          
         <lu-math-row-chunk>
            + <mark class="mark-2">(<var>R<sub>o</sub></var> &bullet; <var>R<sub>o</sub></var>)</mark>
         </lu-math-row-chunk>
          
         <lu-math-row-chunk>
            + <mark class="mark-2">(<var>C<sub>b</sub></var> &bullet; <var>C<sub>b</sub></var>)</mark>
         </lu-math-row-chunk>
      </lu-math-row>
      <lu-math-row>
         <lu-math-row-chunk>
            (<!--
            -->((<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var>){{ lu_math_sq }}
             + ((<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var>){{ lu_math_sq }}
             + ((<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var>){{ lu_math_sq }}<!--
         -->)<var>H<sub>d</sub></var>{{lu_math_sq}}
         </lu-math-row-chunk>
         <lu-math-row-chunk>
            +
            (<!--
            -->2(<!--
               -->(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ax</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var><var>C<sub>bx</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var><var>R<sub>dx</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var><var>R<sub>ox</sub></var><!--
            -->)
               +
               2(<!--
               -->(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ay</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ay</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var><var>C<sub>by</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var><var>R<sub>dy</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var><var>R<sub>oy</sub></var><!--
            -->)
               +
               2(<!--
               -->(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>az</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>az</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var><var>C<sub>bz</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var><var>R<sub>dz</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var><var>R<sub>oz</sub></var><!--
            -->)<!--
         -->)<var>H<sub>d</sub></var>
         </lu-math-row-chunk>
         
         <lu-math-row-chunk>
            - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)
            + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)
            + 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)
            + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)
            - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>a</sub></var>)
            - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)
            + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)
            + 2(<var>R<sub>d</sub></var> &bullet; <var>R<sub>o</sub></var>)
            + 2(<var>R<sub>d</sub></var> &bullet; <var>C<sub>b</sub></var>)
            + 2(<var>R<sub>o</sub></var> &bullet; <var>C<sub>b</sub></var>)
         </lu-math-row-chunk>
          
         <lu-math-row-chunk>
          + (<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ax</sub></var>{{lu_math_sq}}
          + (<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ay</sub></var>{{lu_math_sq}}
          + (<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>az</sub></var>{{lu_math_sq}}
         </lu-math-row-chunk>
          
         <lu-math-row-chunk>
          + (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var>{{lu_math_sq}}
          + (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ay</sub></var>{{lu_math_sq}}
          + (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>az</sub></var>{{lu_math_sq}}
         </lu-math-row-chunk>
          
         <lu-math-row-chunk>
            + (<var>R<sub>d</sub></var> &bullet; <var>R<sub>d</sub></var>)
            + (<var>R<sub>o</sub></var> &bullet; <var>R<sub>o</sub></var>)
            + (<var>C<sub>b</sub></var> &bullet; <var>C<sub>b</sub></var>)
         </lu-math-row-chunk>
      </lu-math-row>
      <lu-math-row>
         <lu-math-row-chunk>
            (<!--
            -->((<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var>){{ lu_math_sq }}
             + ((<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var>){{ lu_math_sq }}
             + ((<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var>){{ lu_math_sq }}<!--
         -->)<var>H<sub>d</sub></var>{{lu_math_sq}}
         </lu-math-row-chunk>
         <lu-math-row-chunk>
            +
            (<!--
            -->2(<!--
               -->(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ax</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var><var>C<sub>bx</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var><var>R<sub>dx</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var><var>R<sub>ox</sub></var><!--
            -->)
               +
               2(<!--
               -->(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ay</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ay</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var><var>C<sub>by</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var><var>R<sub>dy</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var><var>R<sub>oy</sub></var><!--
            -->)
               +
               2(<!--
               -->(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>az</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>az</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var><var>C<sub>bz</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var><var>R<sub>dz</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var><var>R<sub>oz</sub></var><!--
            -->)<!--
         -->)<var>H<sub>d</sub></var>
         </lu-math-row-chunk>
         
         <lu-math-row-chunk>
            - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)
            + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)
            + 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)
            + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)
            - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>a</sub></var>)
            - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)
            + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)
            + 2(<var>R<sub>d</sub></var> &bullet; <var>R<sub>o</sub></var>)
            + 2(<var>R<sub>d</sub></var> &bullet; <var>C<sub>b</sub></var>)
            + 2(<var>R<sub>o</sub></var> &bullet; <var>C<sub>b</sub></var>)
         </lu-math-row-chunk>
          
         <lu-math-row-chunk>
          + (<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<mark>(<var>C<sub>ax</sub></var> &bullet; <var>C<sub>ax</sub></var>)</mark>
         </lu-math-row-chunk>
          
         <lu-math-row-chunk>
          + (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<mark>(<var>C<sub>ax</sub></var> &bullet; <var>C<sub>ax</sub></var>)</mark>
         </lu-math-row-chunk>
          
         <lu-math-row-chunk>
            + (<var>R<sub>d</sub></var> &bullet; <var>R<sub>d</sub></var>)
            + (<var>R<sub>o</sub></var> &bullet; <var>R<sub>o</sub></var>)
            + (<var>C<sub>b</sub></var> &bullet; <var>C<sub>b</sub></var>)
         </lu-math-row-chunk>
      </lu-math-row>
      <lu-math-row>
         <lu-math-row-chunk>
            (<!--
            -->((<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var>)<mark>((<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var>)</mark>
             + ((<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var>)<mark>((<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var>)</mark>
             + ((<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var>)<mark>((<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var>)</mark><!--
         -->)<var>H<sub>d</sub></var>{{lu_math_sq}}
         </lu-math-row-chunk>
         <lu-math-row-chunk>
            +
            (<!--
            -->2(<!--
               -->(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ax</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var><var>C<sub>bx</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var><var>R<sub>dx</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var><var>R<sub>ox</sub></var><!--
            -->)
               +
               2(<!--
               -->(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ay</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ay</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var><var>C<sub>by</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var><var>R<sub>dy</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var><var>R<sub>oy</sub></var><!--
            -->)
               +
               2(<!--
               -->(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>az</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>az</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var><var>C<sub>bz</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var><var>R<sub>dz</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var><var>R<sub>oz</sub></var><!--
            -->)<!--
         -->)<var>H<sub>d</sub></var>
         </lu-math-row-chunk>
         
         <lu-math-row-chunk>
            - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)
            + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)
            + 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)
            + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)
            - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>a</sub></var>)
            - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)
            + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)
            + 2(<var>R<sub>d</sub></var> &bullet; <var>R<sub>o</sub></var>)
            + 2(<var>R<sub>d</sub></var> &bullet; <var>C<sub>b</sub></var>)
            + 2(<var>R<sub>o</sub></var> &bullet; <var>C<sub>b</sub></var>)
            + (<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>ax</sub></var> &bullet; <var>C<sub>ax</sub></var>)
            + (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>ax</sub></var> &bullet; <var>C<sub>ax</sub></var>)
            + (<var>R<sub>d</sub></var> &bullet; <var>R<sub>d</sub></var>)
            + (<var>R<sub>o</sub></var> &bullet; <var>R<sub>o</sub></var>)
            + (<var>C<sub>b</sub></var> &bullet; <var>C<sub>b</sub></var>)
         </lu-math-row-chunk>
      </lu-math-row>
      <lu-math-row>
         <lu-math-row-chunk>
            (<!--
            -->(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var>{{lu_math_sq}}
             + (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var>{{lu_math_sq}}
             +((<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var>{{lu_math_sq}}<!--
         -->)<var>H<sub>d</sub></var>{{lu_math_sq}}
         </lu-math-row-chunk>
         <lu-math-row-chunk>
            +
            (<!--
            -->2(<!--
               -->(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ax</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ax</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var><var>C<sub>bx</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var><var>R<sub>dx</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var><var>R<sub>ox</sub></var><!--
            -->)
               +
               2(<!--
               -->(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>ay</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>ay</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var><var>C<sub>by</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var><var>R<sub>dy</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var><var>R<sub>oy</sub></var><!--
            -->)
               +
               2(<!--
               -->(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<var>C<sub>az</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<var>C<sub>az</sub></var>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var><var>C<sub>bz</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var><var>R<sub>dz</sub></var>
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var><var>R<sub>oz</sub></var><!--
            -->)<!--
         -->)<var>H<sub>d</sub></var>
         </lu-math-row-chunk>
         
         <lu-math-row-chunk>
            - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)
            + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)
            + 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)
            + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)
            - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>a</sub></var>)
            - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)
            + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)
            + 2(<var>R<sub>d</sub></var> &bullet; <var>R<sub>o</sub></var>)
            + 2(<var>R<sub>d</sub></var> &bullet; <var>C<sub>b</sub></var>)
            + 2(<var>R<sub>o</sub></var> &bullet; <var>C<sub>b</sub></var>)
            + (<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>ax</sub></var> &bullet; <var>C<sub>ax</sub></var>)
            + (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>ax</sub></var> &bullet; <var>C<sub>ax</sub></var>)
            + (<var>R<sub>d</sub></var> &bullet; <var>R<sub>d</sub></var>)
            + (<var>R<sub>o</sub></var> &bullet; <var>R<sub>o</sub></var>)
            + (<var>C<sub>b</sub></var> &bullet; <var>C<sub>b</sub></var>)
         </lu-math-row-chunk>
      </lu-math-row>
      <lu-math-row>
         <lu-math-row-chunk>
            (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<mark>(<var>C<sub>a</sub></var> &bullet; <var>C<sub>a</sub></var>)</mark><var>H<sub>d</sub></var>{{lu_math_sq}}
         </lu-math-row-chunk>
         <lu-math-row-chunk>
            +
            <mark>2</mark>(<!--
            -->(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var><mark>{{lu_math_sq}}</mark>
             - (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var><mark>{{lu_math_sq}}</mark>
             - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var><var>C<sub>bx</sub></var>
             - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var><var>R<sub>dx</sub></var>
             - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var><var>R<sub>ox</sub></var>
               +
               (<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var><mark>{{lu_math_sq}}</mark>
             - (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var><mark>{{lu_math_sq}}</mark>
             - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var><var>C<sub>by</sub></var>
             - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var><var>R<sub>dy</sub></var>
             - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var><var>R<sub>oy</sub></var>
               +
               (<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var><mark>{{lu_math_sq}}</mark>
             - (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var><mark>{{lu_math_sq}}</mark>
             - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var><var>C<sub>bz</sub></var>
             - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var><var>R<sub>dz</sub></var>
             - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var><var>R<sub>oz</sub></var><!--
         -->)<var>H<sub>d</sub></var>
         </lu-math-row-chunk>
         
         <lu-math-row-chunk>
            - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)
            + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)
            + 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)
            + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)
            - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>a</sub></var>)
            - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)
            + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)
            + 2(<var>R<sub>d</sub></var> &bullet; <var>R<sub>o</sub></var>)
            + 2(<var>R<sub>d</sub></var> &bullet; <var>C<sub>b</sub></var>)
            + 2(<var>R<sub>o</sub></var> &bullet; <var>C<sub>b</sub></var>)
            + (<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>ax</sub></var> &bullet; <var>C<sub>ax</sub></var>)
            + (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>ax</sub></var> &bullet; <var>C<sub>ax</sub></var>)
            + (<var>R<sub>d</sub></var> &bullet; <var>R<sub>d</sub></var>)
            + (<var>R<sub>o</sub></var> &bullet; <var>R<sub>o</sub></var>)
            + (<var>C<sub>b</sub></var> &bullet; <var>C<sub>b</sub></var>)
         </lu-math-row-chunk>
      </lu-math-row>
   </lu-math>
   <p>
      Let's rearrange some terms, and then keep going.
   </p>
   <lu-math data-enormous-rows>
      <lu-math-row>
         <lu-math-row-chunk>
            (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>a</sub></var>)<var>H<sub>d</sub></var>{{lu_math_sq}}
            +
            2(
            <lu-math-row-chunk>
               (<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var>{{lu_math_sq}}
               + (<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var>{{lu_math_sq}}
               + (<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var>{{lu_math_sq}}
            </lu-math-row-chunk>
            <lu-math-row-chunk>
               - (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var>{{lu_math_sq}}
               - (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var>{{lu_math_sq}}
               - (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var>{{lu_math_sq}}
            </lu-math-row-chunk>
            <lu-math-row-chunk>
               - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var><var>C<sub>bx</sub></var>
               - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var><var>C<sub>by</sub></var>
               - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var><var>C<sub>bz</sub></var>
            </lu-math-row-chunk>
            <lu-math-row-chunk>
               - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var><var>R<sub>dx</sub></var>
               - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var><var>R<sub>dy</sub></var>
               - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var><var>R<sub>dz</sub></var>
            </lu-math-row-chunk>
            <lu-math-row-chunk>
               - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ax</sub></var><var>R<sub>ox</sub></var>
               - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>ay</sub></var><var>R<sub>oy</sub></var>
               - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>C<sub>az</sub></var><var>R<sub>oz</sub></var>
            </lu-math-row-chunk>
         
            )<var>H<sub>d</sub></var>
         </lu-math-row-chunk>
         <lu-math-row-chunk>
            - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)
            + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)
            + 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)
            + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)
            - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>a</sub></var>)
            - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)
            + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)
            + 2(<var>R<sub>d</sub></var> &bullet; <var>R<sub>o</sub></var>)
            + 2(<var>R<sub>d</sub></var> &bullet; <var>C<sub>b</sub></var>)
            + 2(<var>R<sub>o</sub></var> &bullet; <var>C<sub>b</sub></var>)
            + (<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>ax</sub></var> &bullet; <var>C<sub>ax</sub></var>)
            + (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>ax</sub></var> &bullet; <var>C<sub>ax</sub></var>)
            + (<var>R<sub>d</sub></var> &bullet; <var>R<sub>d</sub></var>)
            + (<var>R<sub>o</sub></var> &bullet; <var>R<sub>o</sub></var>)
            + (<var>C<sub>b</sub></var> &bullet; <var>C<sub>b</sub></var>)
         </lu-math-row-chunk>
      </lu-math-row>
      <lu-math-row>
         <lu-math-row-chunk>
            (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>a</sub></var>)<var>H<sub>d</sub></var>{{lu_math_sq}}
            +
            2(
            <lu-math-row-chunk>
               (<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<mark class="mark-1">(<var>C<sub>a</sub></var> &bullet; <var>C<sub>a</sub></var>)</mark>
            </lu-math-row-chunk>
            <lu-math-row-chunk>
               - (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<mark class="mark-2">(<var>C<sub>a</sub></var> &bullet; <var>C<sub>a</sub></var>)</mark>
            </lu-math-row-chunk>
            <lu-math-row-chunk>
               - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<mark class="mark-3">(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)</mark>
            </lu-math-row-chunk>
            <lu-math-row-chunk>
               - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<mark class="mark-4">(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)</mark>
            </lu-math-row-chunk>
            <lu-math-row-chunk>
               - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<mark class="mark-5">(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)</mark>
            </lu-math-row-chunk>
         
            )<var>H<sub>d</sub></var>
         </lu-math-row-chunk>
         <lu-math-row-chunk>
            - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)
            + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)
            + 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)
            + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)
            - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>a</sub></var>)
            - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)
            + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)
            + 2(<var>R<sub>d</sub></var> &bullet; <var>R<sub>o</sub></var>)
            + 2(<var>R<sub>d</sub></var> &bullet; <var>C<sub>b</sub></var>)
            + 2(<var>R<sub>o</sub></var> &bullet; <var>C<sub>b</sub></var>)
            + (<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>ax</sub></var> &bullet; <var>C<sub>ax</sub></var>)
            + (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>ax</sub></var> &bullet; <var>C<sub>ax</sub></var>)
            + (<var>R<sub>d</sub></var> &bullet; <var>R<sub>d</sub></var>)
            + (<var>R<sub>o</sub></var> &bullet; <var>R<sub>o</sub></var>)
            + (<var>C<sub>b</sub></var> &bullet; <var>C<sub>b</sub></var>)
         </lu-math-row-chunk>
      </lu-math-row>
   </lu-math>
   <p>
      We've combined everything back into vectors. Now, let's rearrange things a bit, to clean this behemoth of an expression up.
   </p>
   <lu-math>
      <lu-math-row>
         <lu-math-row-chunk>
            (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>a</sub></var>)<var>H<sub>d</sub></var>{{lu_math_sq}}
            +
            2(
            <lu-math-row-chunk>
               <mark>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)(<!--
               -->(<!--
                  --><var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>
                   - (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<!--
               -->)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>a</sub></var>)
                - (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<!--
            -->)</mark>
            </lu-math-row-chunk>
         
            )<var>H<sub>d</sub></var>
         </lu-math-row-chunk>
         <lu-math-row-chunk>
            + (<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<mark>{{lu_math_sq}}</mark>(<var>C<sub>a</sub></var> &bullet; <var>C<sub>a</sub></var>)
            + (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<mark>{{lu_math_sq}}</mark>(<var>C<sub>a</sub></var> &bullet; <var>C<sub>a</sub></var>)
         </lu-math-row-chunk>
         <lu-math-row-chunk>
            + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<mark>{{lu_math_sq}}</mark>
            + 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<mark>{{lu_math_sq}}</mark>
         </lu-math-row-chunk>
         <lu-math-row-chunk>
            + <mark>2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)(<!--
            -->(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)
             - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<!--
         -->)</mark>
         </lu-math-row-chunk>
         <lu-math-row-chunk>
            + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)
            - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>a</sub></var>)
            - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)
         </lu-math-row-chunk>
         <lu-math-row-chunk>
            + 2(<var>R<sub>d</sub></var> &bullet; <var>R<sub>o</sub></var>)
            + 2(<var>R<sub>d</sub></var> &bullet; <var>C<sub>b</sub></var>)
            + 2(<var>R<sub>o</sub></var> &bullet; <var>C<sub>b</sub></var>)
            + (<var>R<sub>d</sub></var> &bullet; <var>R<sub>d</sub></var>)
            + (<var>R<sub>o</sub></var> &bullet; <var>R<sub>o</sub></var>)
            + (<var>C<sub>b</sub></var> &bullet; <var>C<sub>b</sub></var>)
         </lu-math-row-chunk>
      </lu-math-row>
   </lu-math>
   <p>
      The vector <lu-math data-inline><var>C<sub>a</sub></var></lu-math> is a normalized axis vector, so its length is 1. This means that the dot product of this vector with itself &mdash; its length squared &mdash; is also 1, so we can prune it out of the multiplications.
   </p>
   <lu-math data-enormous-rows>
      <lu-math-row>
         <lu-math-row-chunk>
            (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<var>H<sub>d</sub></var>{{lu_math_sq}}
            +
            2(
            <lu-math-row-chunk>
               (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)(<!--
               -->(<!--
                  --><var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>
                   - (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<!--
               -->)
                - (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<!--
            -->)
            </lu-math-row-chunk>
         
            )<var>H<sub>d</sub></var>
         </lu-math-row-chunk>
         <lu-math-row-chunk>
            + (<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>){{lu_math_sq}}
            + (<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>){{lu_math_sq}}
         </lu-math-row-chunk>
         <lu-math-row-chunk>
            + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>){{lu_math_sq}}
            + 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>){{lu_math_sq}}
         </lu-math-row-chunk>
         <lu-math-row-chunk>
            + 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)(<!--
            -->(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)
             - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<!--
         -->)
         </lu-math-row-chunk>
         <lu-math-row-chunk>
            + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)
            - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)
            - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)
         </lu-math-row-chunk>
         <lu-math-row-chunk>
            + 2(<var>R<sub>d</sub></var> &bullet; <var>R<sub>o</sub></var>)
            + 2(<var>R<sub>d</sub></var> &bullet; <var>C<sub>b</sub></var>)
            + 2(<var>R<sub>o</sub></var> &bullet; <var>C<sub>b</sub></var>)
         </lu-math-row-chunk>
         <lu-math-row-chunk>
            + (<var>R<sub>d</sub></var> &bullet; <var>R<sub>d</sub></var>)
            + (<var>R<sub>o</sub></var> &bullet; <var>R<sub>o</sub></var>)
            + (<var>C<sub>b</sub></var> &bullet; <var>C<sub>b</sub></var>)
         </lu-math-row-chunk>
      </lu-math-row>
      <lu-math-row>
         <lu-math-row-chunk>
            (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<mark>{{lu_math_sq}}</mark><var>H<sub>d</sub></var>{{lu_math_sq}}
            +
            2(
            <lu-math-row-chunk>
               (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)(<!--
               -->-<mark>2</mark>(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<!--
            -->)
            </lu-math-row-chunk>
         
            )<var>H<sub>d</sub></var>
         </lu-math-row-chunk>
         <lu-math-row-chunk>
            + <mark>3</mark>(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>){{lu_math_sq}}
            + <mark>3</mark>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>){{lu_math_sq}}
         </lu-math-row-chunk>
         <lu-math-row-chunk>
            + 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)(<!--
            -->(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)
             - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<!--
         -->)
         </lu-math-row-chunk>
         <lu-math-row-chunk>
            + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)
            - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)
            - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)
         </lu-math-row-chunk>
         <lu-math-row-chunk>
            + 2(<var>R<sub>d</sub></var> &bullet; <var>R<sub>o</sub></var>)
            + 2(<var>R<sub>d</sub></var> &bullet; <var>C<sub>b</sub></var>)
            + 2(<var>R<sub>o</sub></var> &bullet; <var>C<sub>b</sub></var>)
         </lu-math-row-chunk>
         <lu-math-row-chunk>
            + (<var>R<sub>d</sub></var> &bullet; <var>R<sub>d</sub></var>)
            + (<var>R<sub>o</sub></var> &bullet; <var>R<sub>o</sub></var>)
            + (<var>C<sub>b</sub></var> &bullet; <var>C<sub>b</sub></var>)
         </lu-math-row-chunk>
      </lu-math-row>
      <lu-math-row>
         <lu-math-row-chunk>
            (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>){{lu_math_sq}}<var>H<sub>d</sub></var>{{lu_math_sq}}
            <mark>-</mark>
            2(<!--
            -->(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)(<!--
               -->2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)
                <mark>+</mark> (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<!--
            -->)<!--
         -->)<var>H<sub>d</sub></var>
         </lu-math-row-chunk>
         <lu-math-row-chunk>
            + 3(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>){{lu_math_sq}}
            + 3(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>){{lu_math_sq}}
         </lu-math-row-chunk>
         <lu-math-row-chunk>
            + 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)(<!--
            -->(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)
             - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<!--
         -->)
         </lu-math-row-chunk>
         <lu-math-row-chunk>
            + 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)
            - 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)
            - 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)
         </lu-math-row-chunk>
         <lu-math-row-chunk>
            + 2(<var>R<sub>d</sub></var> &bullet; <var>R<sub>o</sub></var>)
            + 2(<var>R<sub>d</sub></var> &bullet; <var>C<sub>b</sub></var>)
            + 2(<var>R<sub>o</sub></var> &bullet; <var>C<sub>b</sub></var>)
         </lu-math-row-chunk>
         <lu-math-row-chunk>
            + (<var>R<sub>d</sub></var> &bullet; <var>R<sub>d</sub></var>)
            + (<var>R<sub>o</sub></var> &bullet; <var>R<sub>o</sub></var>)
            + (<var>C<sub>b</sub></var> &bullet; <var>C<sub>b</sub></var>)
         </lu-math-row-chunk>
      </lu-math-row>
      <lu-math-row>
         <lu-math-row-chunk>
            (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>){{lu_math_sq}}<var>H<sub>d</sub></var>{{lu_math_sq}}
            -
            2(<!--
            -->(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)(<!--
               -->2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)
                + (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<!--
            -->)<!--
         -->)<var>H<sub>d</sub></var>
         </lu-math-row-chunk>
         <lu-math-row-chunk>
            + 3(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>){{lu_math_sq}}
            + 3(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>){{lu_math_sq}}
         </lu-math-row-chunk>
         <lu-math-row-chunk>
            + 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)(<!--
            -->(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)
             - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<!--
         -->)
         </lu-math-row-chunk>
         <lu-math-row-chunk>
            - 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)
         </lu-math-row-chunk>
         <lu-math-row-chunk>
            + 2(<var>R<sub>d</sub></var> &bullet; <var>R<sub>o</sub></var>)
            + 2(<var>R<sub>d</sub></var> &bullet; <var>C<sub>b</sub></var>)
            + 2(<var>R<sub>o</sub></var> &bullet; <var>C<sub>b</sub></var>)
         </lu-math-row-chunk>
         <lu-math-row-chunk>
            + (<var>R<sub>d</sub></var> &bullet; <var>R<sub>d</sub></var>)
            + (<var>R<sub>o</sub></var> &bullet; <var>R<sub>o</sub></var>)
            + (<var>C<sub>b</sub></var> &bullet; <var>C<sub>b</sub></var>)
         </lu-math-row-chunk>
      </lu-math-row>
      <lu-math-row>
         <lu-math-row-chunk>
            (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>){{lu_math_sq}}<var>H<sub>d</sub></var>{{lu_math_sq}}
            -
            2(<!--
            -->2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)<mark>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)</mark>
             + (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<mark>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)</mark><!--
         -->)<var>H<sub>d</sub></var>
         </lu-math-row-chunk>
         <lu-math-row-chunk>
            + 3(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>){{lu_math_sq}}
            + 3(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>){{lu_math_sq}}
         </lu-math-row-chunk>
         <lu-math-row-chunk>
            + 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)(<!--
            -->(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)
             - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<!--
         -->)
         </lu-math-row-chunk>
         <lu-math-row-chunk>
            - 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)
         </lu-math-row-chunk>
         <lu-math-row-chunk>
            + 2(<var>R<sub>d</sub></var> &bullet; <var>R<sub>o</sub></var>)
            + 2(<var>R<sub>d</sub></var> &bullet; <var>C<sub>b</sub></var>)
            + 2(<var>R<sub>o</sub></var> &bullet; <var>C<sub>b</sub></var>)
         </lu-math-row-chunk>
         <lu-math-row-chunk>
            + (<var>R<sub>d</sub></var> &bullet; <var>R<sub>d</sub></var>)
            + (<var>R<sub>o</sub></var> &bullet; <var>R<sub>o</sub></var>)
            + (<var>C<sub>b</sub></var> &bullet; <var>C<sub>b</sub></var>)
         </lu-math-row-chunk>
      </lu-math-row>
      <lu-math-row>
         <lu-math-row-chunk>
            (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>){{lu_math_sq}}<var>H<sub>d</sub></var>{{lu_math_sq}}
            -
            (<!--
            --><mark>4</mark>(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)
             + <mark>2</mark>(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<!--
         -->)<var>H<sub>d</sub></var>
         </lu-math-row-chunk>
         <lu-math-row-chunk>
            + 3(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>){{lu_math_sq}}
            + 3(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>){{lu_math_sq}}
         </lu-math-row-chunk>
         <lu-math-row-chunk>
            + 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)(<!--
            -->(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)
             - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<!--
         -->)
         </lu-math-row-chunk>
         <lu-math-row-chunk>
            - 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)
         </lu-math-row-chunk>
         <lu-math-row-chunk>
            + 2(<var>R<sub>d</sub></var> &bullet; <var>R<sub>o</sub></var>)
            + 2(<var>R<sub>d</sub></var> &bullet; <var>C<sub>b</sub></var>)
            + 2(<var>R<sub>o</sub></var> &bullet; <var>C<sub>b</sub></var>)
         </lu-math-row-chunk>
         <lu-math-row-chunk>
            + (<var>R<sub>d</sub></var> &bullet; <var>R<sub>d</sub></var>)
            + (<var>R<sub>o</sub></var> &bullet; <var>R<sub>o</sub></var>)
            + (<var>C<sub>b</sub></var> &bullet; <var>C<sub>b</sub></var>)
         </lu-math-row-chunk>
      </lu-math-row>
   </lu-math>
   <p>
      Let's plug this back into the complete equation:
   </p>
   <lu-math>
      <lu-math-row>
         (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>){{lu_math_sq}}<var>H<sub>d</sub></var>{{lu_math_sq}}
         -
         (<!--
         -->4(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)
          + 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)<!--
      -->)<var>H<sub>d</sub></var>
         + 3(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>){{lu_math_sq}}
         + 3(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>){{lu_math_sq}}
         + 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)(<!--
         -->(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)
          - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<!--
      -->)
         - 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)
         + 2(<var>R<sub>d</sub></var> &bullet; <var>R<sub>o</sub></var>)
         + 2(<var>R<sub>d</sub></var> &bullet; <var>C<sub>b</sub></var>)
         + 2(<var>R<sub>o</sub></var> &bullet; <var>C<sub>b</sub></var>)
         + (<var>R<sub>d</sub></var> &bullet; <var>R<sub>d</sub></var>)
         + (<var>R<sub>o</sub></var> &bullet; <var>R<sub>o</sub></var>)
         + (<var>C<sub>b</sub></var> &bullet; <var>C<sub>b</sub></var>)
         = 
         <var>C<sub>r</sub></var>{{ lu_math_sq }}
      </lu-math-row>
   </lu-math>
   <p>
      Let's move the radius onto the lefthand side.
   </p>
   <lu-math>
      <lu-math-row>
         (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>){{lu_math_sq}}<var>H<sub>d</sub></var>{{lu_math_sq}}
         -
         (<!--
         -->4(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)
          + 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>){{lu_math_sq}}<!--
      -->)<var>H<sub>d</sub></var>
         + 3(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>){{lu_math_sq}}
         + 3(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>){{lu_math_sq}}
         + 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)(<!--
         -->(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)
          - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<!--
      -->)
         - 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)
         + 2(<var>R<sub>d</sub></var> &bullet; <var>R<sub>o</sub></var>)
         + 2(<var>R<sub>d</sub></var> &bullet; <var>C<sub>b</sub></var>)
         + 2(<var>R<sub>o</sub></var> &bullet; <var>C<sub>b</sub></var>)
         + (<var>R<sub>d</sub></var> &bullet; <var>R<sub>d</sub></var>)
         + (<var>R<sub>o</sub></var> &bullet; <var>R<sub>o</sub></var>)
         + (<var>C<sub>b</sub></var> &bullet; <var>C<sub>b</sub></var>)<mark> - <var>C<sub>r</sub></var>{{ lu_math_sq }}</mark>
         = 
         0
      </lu-math-row>
   </lu-math>
   <p>
      And as with <a href="{% link _articles/ray-cone-intersection.html %}">ray/cone intersections</a>, we've found ourselves facing a quadratic equation.
   </p>
   <lu-math>
      <lu-math-row>
         <mark class="mark-1">(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>){{lu_math_sq}}</mark><var>H<sub>d</sub></var>{{lu_math_sq}}
         <mark class="mark-2">-
         (<!--
         -->4(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)
          + 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>){{lu_math_sq}}<!--
      -->)</mark><var>H<sub>d</sub></var>
         + <mark class="mark-3">3(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>){{lu_math_sq}}
         + 3(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>){{lu_math_sq}}
         + 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)(<!--
         -->(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)
          - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<!--
      -->)
         - 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)
         + 2(<var>R<sub>d</sub></var> &bullet; <var>R<sub>o</sub></var>)
         + 2(<var>R<sub>d</sub></var> &bullet; <var>C<sub>b</sub></var>)
         + 2(<var>R<sub>o</sub></var> &bullet; <var>C<sub>b</sub></var>)
         + (<var>R<sub>d</sub></var> &bullet; <var>R<sub>d</sub></var>)
         + (<var>R<sub>o</sub></var> &bullet; <var>R<sub>o</sub></var>)
         + (<var>C<sub>b</sub></var> &bullet; <var>C<sub>b</sub></var>)
         - <var>C<sub>r</sub></var>{{ lu_math_sq }}</mark>
         = 
         0
      </lu-math-row>
      <lu-math-aligned>
         <lu-math-row>
            <var>a</var> = (<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>){{lu_math_sq}}
         </lu-math-row>
         <lu-math-row>
            <var>b</var> = -4(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)
             - 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>){{lu_math_sq}}
         </lu-math-row>
         <lu-math-row>
            <var>c</var> = 3(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>){{lu_math_sq}}
               + 3(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>){{lu_math_sq}}
               + 2(<var>C<sub>a</sub></var> &bullet; <var>R<sub>d</sub></var>)(<!--
               -->(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)
                - (<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)<!--
            -->)
               - 2(<var>C<sub>a</sub></var> &bullet; <var>C<sub>b</sub></var>)(<var>C<sub>a</sub></var> &bullet; <var>R<sub>o</sub></var>)
               + 2(<var>R<sub>d</sub></var> &bullet; <var>R<sub>o</sub></var>)
               + 2(<var>R<sub>d</sub></var> &bullet; <var>C<sub>b</sub></var>)
               + 2(<var>R<sub>o</sub></var> &bullet; <var>C<sub>b</sub></var>)
               + (<var>R<sub>d</sub></var> &bullet; <var>R<sub>d</sub></var>)
               + (<var>R<sub>o</sub></var> &bullet; <var>R<sub>o</sub></var>)
               + (<var>C<sub>b</sub></var> &bullet; <var>C<sub>b</sub></var>)
               - <var>C<sub>r</sub></var>{{ lu_math_sq }}</mark>
         </lu-math-row>
      </lu-math-aligned>
   </lu-math>
   
   
   <p>
      I'm... not fully confident in this. It needs testing, and I feel like there are better solutions that I'm missing. Somehow this is more complex than the cone solution despite dealing with what is, conceptually, a simpler shape.
   </p>
   
   
   <!-- CONTINUE FROM HERE -->
   
</section>